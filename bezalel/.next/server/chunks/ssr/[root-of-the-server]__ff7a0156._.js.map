{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///C:/bridge/Bezalel/bezalel/src/components/Canvas.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useImperativeHandle, forwardRef } from \"react\";\r\nimport { Canvas as FabricJSCanvas, PencilBrush, Pattern, Path } from \"fabric\";\r\nimport { useTheme } from \"next-themes\";\r\n\r\ninterface CanvasProps {\r\n    isDrawingMode: boolean;\r\n    setCanvasRef?: (canvas: FabricJSCanvas | null) => void;\r\n    onPathCreated?: (path: Path) => void;\r\n    width?: number;\r\n    height?: number;\r\n    brushColor?: string;\r\n    brushWidth?: number;\r\n    showGrid?: boolean;\r\n}\r\n\r\nconst Canvas = forwardRef(function Canvas(\r\n    {\r\n        isDrawingMode,\r\n        setCanvasRef,\r\n        onPathCreated,\r\n        width = 5000,\r\n        height = 3500,\r\n        brushColor = \"#000000\",\r\n        brushWidth = 3,\r\n        showGrid = true,\r\n    }: CanvasProps,\r\n    ref\r\n) {\r\n    const canvasElRef = useRef<HTMLCanvasElement | null>(null);\r\n    const fabricRef = useRef<FabricJSCanvas | null>(null);\r\n    const patternCacheRef = useRef<HTMLCanvasElement | null>(null);\r\n    const { theme } = useTheme();\r\n\r\n    const setZoom = (zoom: number, point?: { x: number; y: number }) => {\r\n        if (!fabricRef.current) return;\r\n        if (!point) point = { x: fabricRef.current.getWidth()! / 2, y: fabricRef.current.getHeight()! / 2 };\r\n        fabricRef.current.zoomToPoint(point, zoom);\r\n    };\r\n\r\n    useImperativeHandle(ref, () => ({\r\n        zoomIn: () => fabricRef.current && setZoom(fabricRef.current.getZoom() * 1.1),\r\n        zoomOut: () => fabricRef.current && setZoom(fabricRef.current.getZoom() / 1.1),\r\n        resetZoom: () => fabricRef.current && setZoom(1),\r\n        toJSON: () => fabricRef.current?.toJSON(),\r\n        loadFromJSON: (json: any) => {\r\n            if (!fabricRef.current) return;\r\n            fabricRef.current.loadFromJSON(json || {}, () => fabricRef.current!.renderAll());\r\n        },\r\n    }));\r\n\r\n    useEffect(() => {\r\n        if (!canvasElRef.current) return;\r\n\r\n        const fcanvas = new FabricJSCanvas(canvasElRef.current, {\r\n            isDrawingMode,\r\n            width,\r\n            height,\r\n            selection: false,\r\n            backgroundColor: theme === \"dark\" ? \"#1a1a1a\" : \"#ffffff\",\r\n        });\r\n\r\n        fabricRef.current = fcanvas;\r\n\r\n        fcanvas.freeDrawingBrush = new PencilBrush(fcanvas);\r\n        fcanvas.freeDrawingBrush.width = brushWidth;\r\n        fcanvas.freeDrawingBrush.color = brushColor;\r\n\r\n        if (onPathCreated) {\r\n            fcanvas.on(\"path:created\", (opts: any) => {\r\n                const path = opts.path as Path | undefined;\r\n                if (path) onPathCreated(path);\r\n            });\r\n        }\r\n\r\n        // grid\r\n        const makeGridPattern = () => {\r\n            const gridSize = 40;\r\n            const gridCanvas = document.createElement(\"canvas\");\r\n            gridCanvas.width = gridSize;\r\n            gridCanvas.height = gridSize;\r\n            const ctx = gridCanvas.getContext(\"2d\");\r\n            if (ctx) {\r\n                ctx.clearRect(0, 0, gridSize, gridSize);\r\n                ctx.fillStyle = theme === \"dark\" ? \"rgba(255,255,255,0.06)\" : \"rgba(0,0,0,0.06)\";\r\n                ctx.beginPath();\r\n                ctx.arc(gridSize / 2, gridSize / 2, 0.8, 0, Math.PI * 2);\r\n                ctx.fill();\r\n            }\r\n            return gridCanvas;\r\n        };\r\n\r\n        patternCacheRef.current = makeGridPattern();\r\n\r\n        if (showGrid && patternCacheRef.current) {\r\n            fcanvas.set(\"backgroundColor\", new Pattern({ source: patternCacheRef.current, repeat: \"repeat\" }));\r\n        }\r\n\r\n        if (setCanvasRef) setCanvasRef(fcanvas);\r\n\r\n        const wheelHandler = (opt: WheelEvent) => {\r\n            if (!fabricRef.current) return;\r\n            if (!(opt.ctrlKey || opt.metaKey)) return;\r\n            opt.preventDefault();\r\n            let zoom = fabricRef.current.getZoom();\r\n            zoom *= 0.999 ** opt.deltaY;\r\n            zoom = Math.min(Math.max(zoom, 0.2), 4);\r\n            setZoom(zoom, { x: opt.offsetX, y: opt.offsetY });\r\n        };\r\n\r\n        canvasElRef.current?.addEventListener(\"wheel\", wheelHandler, { passive: false });\r\n\r\n        return () => {\r\n            fcanvas.dispose();\r\n            if (setCanvasRef) setCanvasRef(null);\r\n            canvasElRef.current?.removeEventListener(\"wheel\", wheelHandler);\r\n        };\r\n    }, []);\r\n\r\n    // dynamic updates\r\n    useEffect(() => {\r\n        if (fabricRef.current) fabricRef.current.isDrawingMode = isDrawingMode;\r\n    }, [isDrawingMode]);\r\n\r\n    useEffect(() => {\r\n        if (fabricRef.current?.freeDrawingBrush) fabricRef.current.freeDrawingBrush.color = brushColor;\r\n    }, [brushColor]);\r\n\r\n    useEffect(() => {\r\n        if (fabricRef.current?.freeDrawingBrush) fabricRef.current.freeDrawingBrush.width = brushWidth;\r\n    }, [brushWidth]);\r\n\r\n    useEffect(() => {\r\n        if (!fabricRef.current) return;\r\n        if (showGrid && patternCacheRef.current) {\r\n            fabricRef.current.set(\"backgroundColor\", new Pattern({ source: patternCacheRef.current, repeat: \"repeat\" }));\r\n        } else {\r\n            fabricRef.current.set(\"backgroundColor\", theme === \"dark\" ? \"#1a1a1a\" : \"#ffffff\");\r\n        }\r\n        fabricRef.current.renderAll();\r\n    }, [showGrid, theme]);\r\n\r\n    return (\r\n        <div className=\"w-full h-full flex justify-center items-center overflow-auto p-6\">\r\n            <canvas\r\n                ref={canvasElRef}\r\n                width={width}\r\n                height={height}\r\n                className=\"block rounded-xl border border-gray-200 shadow-inner\"\r\n                aria-label=\"drawing-canvas\"\r\n            />\r\n        </div>\r\n    );\r\n});\r\n\r\nexport default Canvas;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 267, "column": 0}, "map": {"version":3,"sources":["file:///C:/bridge/Bezalel/bezalel/src/components/PageSidebar.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { Plus, Trash2, ChevronLeft, ChevronRight } from \"lucide-react\";\r\n\r\ninterface PageData {\r\n    id: string;\r\n    name: string;\r\n    canvasData: any;\r\n}\r\n\r\ninterface SidebarProps {\r\n    pages: PageData[];\r\n    activePageId: string;\r\n    onSelectPage: (id: string) => void;\r\n    onAddPage: () => void;\r\n    onRenamePage: (id: string, newName: string) => void;\r\n    onDeletePage: (id: string) => void;\r\n}\r\n\r\nexport default function PageSidebar({\r\n    pages,\r\n    activePageId,\r\n    onSelectPage,\r\n    onAddPage,\r\n    onRenamePage,\r\n    onDeletePage,\r\n}: SidebarProps) {\r\n    const [collapsed, setCollapsed] = useState(false);\r\n    const [editingId, setEditingId] = useState<string | null>(null);\r\n    const [editValue, setEditValue] = useState(\"\");\r\n\r\n    return (\r\n        <aside className={`h-full border-r border-gray-200 bg-gray-50 dark:bg-zinc-900 transition-all duration-300 ${collapsed ? \"w-14\" : \"w-56\"}`}>\r\n            {/* Collapse toggle */}\r\n            <div className=\"flex items-center justify-between p-2 border-b border-gray-200 dark:border-zinc-700\">\r\n                {!collapsed && <span className=\"text-xs font-semibold text-gray-600 dark:text-gray-300\">Pages</span>}\r\n                <button onClick={() => setCollapsed(!collapsed)} className=\"p-1 hover:bg-gray-200 dark:hover:bg-zinc-700 rounded-md\">\r\n                    {collapsed ? <ChevronRight className=\"w-4 h-4 text-gray-600 dark:text-gray-300\" /> : <ChevronLeft className=\"w-4 h-4 text-gray-600 dark:text-gray-300\" />}\r\n                </button>\r\n            </div>\r\n\r\n            {/* Add Page button (always visible at top) */}\r\n            {!collapsed && (\r\n                <div className=\"p-2 border-b border-gray-200 dark:border-zinc-700\">\r\n                    <button\r\n                        onClick={onAddPage}\r\n                        className=\"w-full flex items-center gap-1 justify-center px-2 py-1 text-sm bg-gray-200 dark:bg-zinc-800 hover:bg-gray-300 dark:hover:bg-zinc-700 rounded-md\"\r\n                    >\r\n                        <Plus className=\"w-4 h-4\" /> New Page\r\n                    </button>\r\n                </div>\r\n            )}\r\n\r\n            {/* Pages list */}\r\n            <ul className=\"overflow-y-auto\" style={{ maxHeight: \"calc(100% - 3.5rem)\" }}>\r\n                {pages.map((page) => (\r\n                    <li\r\n                        key={page.id}\r\n                        className={`group flex items-center justify-between px-2 py-1 cursor-pointer text-sm ${activePageId === page.id ? \"bg-gray-200 font-bold dark:bg-zinc-800\" : \"hover:bg-gray-100 dark:hover:bg-zinc-700\"}`}\r\n                        onClick={() => onSelectPage(page.id)}\r\n                        onDoubleClick={() => {\r\n                            setEditingId(page.id);\r\n                            setEditValue(page.name);\r\n                        }}\r\n                    >\r\n                        {editingId === page.id ? (\r\n                            <input\r\n                                value={editValue}\r\n                                onChange={(e) => setEditValue(e.target.value)}\r\n                                onBlur={() => {\r\n                                    onRenamePage(page.id, editValue.trim() || \"Untitled\");\r\n                                    setEditingId(null);\r\n                                }}\r\n                                onKeyDown={(e) => {\r\n                                    if (e.key === \"Enter\") {\r\n                                        onRenamePage(page.id, editValue.trim() || \"Untitled\");\r\n                                        setEditingId(null);\r\n                                    }\r\n                                }}\r\n                                autoFocus\r\n                                className=\"flex-1 bg-white dark:bg-zinc-800 border border-gray-300 dark:border-zinc-700 rounded px-1 text-sm\"\r\n                            />\r\n                        ) : (\r\n                            <span className=\"truncate flex-1\">{page.name}</span>\r\n                        )}\r\n                        {!collapsed && (\r\n                            <button\r\n                                onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                    onDeletePage(page.id);\r\n                                }}\r\n                                className=\"opacity-0 group-hover:opacity-100 p-1 hover:bg-red-100 dark:hover:bg-red-900 rounded-md\"\r\n                            >\r\n                                <Trash2 className=\"w-4 h-4 text-red-500\" />\r\n                            </button>\r\n                        )}\r\n                    </li>\r\n                ))}\r\n            </ul>\r\n        </aside>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAHA;;;;AAoBe,SAAS,YAAY,EAChC,KAAK,EACL,YAAY,EACZ,YAAY,EACZ,SAAS,EACT,YAAY,EACZ,YAAY,EACD;IACX,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAgB;IAC1D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAE3C,qBACI,8OAAC;QAAM,WAAW,CAAC,wFAAwF,EAAE,YAAY,SAAS,QAAQ;;0BAEtI,8OAAC;gBAAI,WAAU;;oBACV,CAAC,2BAAa,8OAAC;wBAAK,WAAU;kCAAyD;;;;;;kCACxF,8OAAC;wBAAO,SAAS,IAAM,aAAa,CAAC;wBAAY,WAAU;kCACtD,0BAAY,8OAAC,sOAAY;4BAAC,WAAU;;;;;iDAAgD,8OAAC,mOAAW;4BAAC,WAAU;;;;;;;;;;;;;;;;;YAKnH,CAAC,2BACE,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC;oBACG,SAAS;oBACT,WAAU;;sCAEV,8OAAC,0MAAI;4BAAC,WAAU;;;;;;wBAAY;;;;;;;;;;;;0BAMxC,8OAAC;gBAAG,WAAU;gBAAkB,OAAO;oBAAE,WAAW;gBAAsB;0BACrE,MAAM,GAAG,CAAC,CAAC,qBACR,8OAAC;wBAEG,WAAW,CAAC,yEAAyE,EAAE,iBAAiB,KAAK,EAAE,GAAG,2CAA2C,4CAA4C;wBACzM,SAAS,IAAM,aAAa,KAAK,EAAE;wBACnC,eAAe;4BACX,aAAa,KAAK,EAAE;4BACpB,aAAa,KAAK,IAAI;wBAC1B;;4BAEC,cAAc,KAAK,EAAE,iBAClB,8OAAC;gCACG,OAAO;gCACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;gCAC5C,QAAQ;oCACJ,aAAa,KAAK,EAAE,EAAE,UAAU,IAAI,MAAM;oCAC1C,aAAa;gCACjB;gCACA,WAAW,CAAC;oCACR,IAAI,EAAE,GAAG,KAAK,SAAS;wCACnB,aAAa,KAAK,EAAE,EAAE,UAAU,IAAI,MAAM;wCAC1C,aAAa;oCACjB;gCACJ;gCACA,SAAS;gCACT,WAAU;;;;;qDAGd,8OAAC;gCAAK,WAAU;0CAAmB,KAAK,IAAI;;;;;;4BAE/C,CAAC,2BACE,8OAAC;gCACG,SAAS,CAAC;oCACN,EAAE,eAAe;oCACjB,aAAa,KAAK,EAAE;gCACxB;gCACA,WAAU;0CAEV,cAAA,8OAAC,oNAAM;oCAAC,WAAU;;;;;;;;;;;;uBApCrB,KAAK,EAAE;;;;;;;;;;;;;;;;AA4CpC","debugId":null}},
    {"offset": {"line": 431, "column": 0}, "map": {"version":3,"sources":["file:///C:/bridge/Bezalel/bezalel/src/components/ThemeToggle.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useTheme } from \"next-themes\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { Sun, Moon } from \"lucide-react\";\r\n\r\nexport default function ThemeToggle() {\r\n    const { theme, setTheme } = useTheme();\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => setMounted(true), []);\r\n    if (!mounted) return null; // avoid hydration mismatch\r\n\r\n    const toggleTheme = () => {\r\n        setTheme(theme === \"dark\" ? \"light\" : \"dark\");\r\n    };\r\n\r\n    return (\r\n        <button\r\n            onClick={toggleTheme}\r\n            aria-label=\"Toggle theme\"\r\n            aria-pressed={theme === \"dark\"}\r\n            title={`Switch to ${theme === \"dark\" ? \"light\" : \"dark\"} mode`}\r\n            className=\"relative flex items-center justify-center p-2 rounded-full \r\n                 bg-gray-100 hover:bg-gray-200 \r\n                 dark:bg-zinc-800 dark:hover:bg-zinc-700\r\n                 transition-all shadow-sm hover:shadow-md\"\r\n        >\r\n            {/* Icon wrapper with animation */}\r\n            <span className=\"absolute transition-transform duration-300 ease-in-out transform \r\n                       rotate-0 opacity-100 dark:-rotate-90 dark:opacity-0\">\r\n                <Sun className=\"w-5 h-5 text-yellow-500\" />\r\n            </span>\r\n            <span className=\"absolute transition-transform duration-300 ease-in-out transform \r\n                       rotate-90 opacity-0 dark:rotate-0 dark:opacity-100\">\r\n                <Moon className=\"w-5 h-5 text-gray-200\" />\r\n            </span>\r\n        </button>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAJA;;;;;AAMe,SAAS;IACpB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,IAAA,4JAAQ;IACpC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC,IAAM,WAAW,OAAO,EAAE;IACpC,IAAI,CAAC,SAAS,OAAO,MAAM,2BAA2B;IAEtD,MAAM,cAAc;QAChB,SAAS,UAAU,SAAS,UAAU;IAC1C;IAEA,qBACI,8OAAC;QACG,SAAS;QACT,cAAW;QACX,gBAAc,UAAU;QACxB,OAAO,CAAC,UAAU,EAAE,UAAU,SAAS,UAAU,OAAO,KAAK,CAAC;QAC9D,WAAU;;0BAMV,8OAAC;gBAAK,WAAU;0BAEZ,cAAA,8OAAC,uMAAG;oBAAC,WAAU;;;;;;;;;;;0BAEnB,8OAAC;gBAAK,WAAU;0BAEZ,cAAA,8OAAC,0MAAI;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAIhC","debugId":null}},
    {"offset": {"line": 499, "column": 0}, "map": {"version":3,"sources":["file:///C:/bridge/Bezalel/bezalel/src/app/board/%5BroomId%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { useParams } from \"next/navigation\";\r\nimport io, { Socket } from \"socket.io-client\";\r\nimport { debounce } from \"lodash\";\r\nimport Canvas from \"@/components/Canvas\";\r\nimport { Canvas as FabricJSCanvas, Object as FabricObject, Path as FabricPath } from \"fabric\";\r\nimport { toast } from \"sonner\";\r\nimport { Pencil, Hand, Undo2, Redo2, Sparkles, Monitor, Grid, ZoomIn, ZoomOut } from \"lucide-react\";\r\nimport PageSidebar from \"@/components/PageSidebar\";\r\nimport { v4 as uuid } from \"uuid\";\r\nimport ThemeToggle from \"@/components/ThemeToggle\";\r\n\r\ntype PageData = {\r\n    id: string;\r\n    name: string;\r\n    canvasData: any | null;\r\n};\r\n\r\nexport default function Board() {\r\n    const { roomId } = useParams();\r\n    const canvasRef = useRef<FabricJSCanvas | null>(null);\r\n    const socketRef = useRef<Socket | null>(null);\r\n    const pcRef = useRef<RTCPeerConnection | null>(null);\r\n    const videoRef = useRef<HTMLVideoElement | null>(null);\r\n    const canvasComponentRef = useRef<any>(null);\r\n\r\n    const [isStreaming, setIsStreaming] = useState(false);\r\n    const [viewerCount, setViewerCount] = useState(0);\r\n    const [aiPrompt, setAiPrompt] = useState(\"\");\r\n    const [isDrawingMode, setIsDrawingMode] = useState(true);\r\n    const [brushColor, setBrushColor] = useState(\"#000000\");\r\n    const [brushWidth, setBrushWidth] = useState(3);\r\n    const [viewUrl, setViewUrl] = useState(\"\");\r\n    const [showGrid, setShowGrid] = useState(true);\r\n\r\n    const undoStack = useRef<FabricObject[]>([]);\r\n    const redoStack = useRef<FabricObject[]>([]);\r\n\r\n    const [pages, setPages] = useState<PageData[]>([{ id: uuid(), name: \"Page 1\", canvasData: null }]);\r\n    const [activePageId, setActivePageId] = useState(pages[0].id);\r\n\r\n    // --- Page management ---\r\n    const handleAddPage = () => {\r\n        const newPage = { id: uuid(), name: `Page ${pages.length + 1}`, canvasData: null };\r\n        setPages((prev) => [...prev, newPage]);\r\n        setActivePageId(newPage.id);\r\n    };\r\n\r\n    const handleRenamePage = (id: string, newName: string) => {\r\n        if (newName.trim() === '') return;\r\n        setPages((prev) => prev.map((p) => (p.id === id ? { ...p, name: newName } : p)));\r\n    };\r\n\r\n    const handleDeletePage = (id: string) => {\r\n        if (pages.length === 1) {\r\n            toast.error(\"Cannot delete the last page.\");\r\n            return;\r\n        }\r\n        setPages((prev) => {\r\n            const remaining = prev.filter((p) => p.id !== id);\r\n            if (activePageId === id) {\r\n                setActivePageId(remaining[0].id);\r\n            }\r\n            return remaining;\r\n        });\r\n    };\r\n\r\n    // --- Save canvas state ---\r\n    const saveCanvasState = debounce((canvas: FabricJSCanvas, pageId: string) => {\r\n        setPages((prevPages) =>\r\n            prevPages.map((p) =>\r\n                p.id === pageId ? { ...p, canvasData: canvas.toJSON(['selectable', 'id']) } : p\r\n            )\r\n        );\r\n    }, 500);\r\n\r\n    useEffect(() => {\r\n        if (!canvasRef.current) return;\r\n\r\n        const handleCanvasChange = () => {\r\n            saveCanvasState(canvasRef.current!, activePageId);\r\n        };\r\n\r\n        canvasRef.current.on(\"object:added\", handleCanvasChange);\r\n        canvasRef.current.on(\"object:modified\", handleCanvasChange);\r\n        canvasRef.current.on(\"object:removed\", handleCanvasChange);\r\n\r\n        return () => {\r\n            canvasRef.current?.off(\"object:added\", handleCanvasChange);\r\n            canvasRef.current?.off(\"object:modified\", handleCanvasChange);\r\n            canvasRef.current?.off(\"object:removed\", handleCanvasChange);\r\n        };\r\n    }, [activePageId]);\r\n\r\n    // --- Load page canvas ---\r\n    useEffect(() => {\r\n        if (!canvasRef.current) return;\r\n\r\n        const activePage = pages.find((p) => p.id === activePageId);\r\n        if (!activePage) return;\r\n\r\n        // Clear canvas and reset stacks\r\n        canvasRef.current.clear();\r\n        undoStack.current = [];\r\n        redoStack.current = [];\r\n\r\n        // Load page data\r\n        if (activePage.canvasData) {\r\n            canvasRef.current.loadFromJSON(activePage.canvasData, () => {\r\n                canvasRef.current!.renderAll();\r\n            });\r\n        } else {\r\n            canvasRef.current.renderAll();\r\n        }\r\n    }, [activePageId]);\r\n\r\n    // --- Safe window usage ---\r\n    useEffect(() => {\r\n        if (typeof window !== \"undefined\") {\r\n            setViewUrl(`${window.location.origin}/board/${roomId}/view`);\r\n        }\r\n    }, [roomId]);\r\n\r\n    // --- Socket.io setup ---\r\n    useEffect(() => {\r\n        const socket = io(process.env.NEXT_PUBLIC_SIGNALING_URL || \"http://localhost:3000\");\r\n        socketRef.current = socket;\r\n        socket.on(\"connect\", () => socket.emit(\"joinSession\", roomId));\r\n        socket.on(\"viewerCount\", (count: number) => setViewerCount(count));\r\n        return () => socket.disconnect();\r\n    }, [roomId]);\r\n\r\n    // --- WebRTC streaming ---\r\n    useEffect(() => {\r\n        if (!isStreaming || !canvasRef.current || !videoRef.current) return;\r\n        const pc = new RTCPeerConnection({ iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }] });\r\n        pcRef.current = pc;\r\n\r\n        const canvasElement = (canvasRef.current as any).lowerCanvasEl ?? (canvasRef.current as any).getElement?.();\r\n        if (!canvasElement || typeof canvasElement.captureStream !== \"function\") {\r\n            toast.error(\"Streaming not supported: unable to capture canvas stream.\");\r\n            return;\r\n        }\r\n\r\n        const canvasStream = canvasElement.captureStream(30);\r\n        navigator.mediaDevices\r\n            .getUserMedia({ video: true, audio: true })\r\n            .then((webcamStream) => {\r\n                const combined = new MediaStream();\r\n                canvasStream.getVideoTracks().forEach((t) => combined.addTrack(t));\r\n                webcamStream.getVideoTracks().forEach((t) => combined.addTrack(t));\r\n                webcamStream.getAudioTracks().forEach((t) => combined.addTrack(t));\r\n                combined.getTracks().forEach((t) => pc.addTrack(t, combined));\r\n                videoRef.current!.srcObject = combined;\r\n            })\r\n            .catch(() => {\r\n                toast.error(\"Could not access webcam â€” streaming canvas only.\");\r\n                canvasStream.getTracks().forEach((t) => pc.addTrack(t, canvasStream));\r\n            });\r\n\r\n        pc.onicecandidate = (ev) => {\r\n            if (ev.candidate) socketRef.current?.emit(\"ice-candidate\", { sessionId: roomId, candidate: ev.candidate });\r\n        };\r\n\r\n        socketRef.current?.on(\"answer\", async (answer: RTCSessionDescriptionInit) => {\r\n            await pc.setRemoteDescription(new RTCSessionDescription(answer));\r\n        });\r\n\r\n        socketRef.current?.on(\"ice-candidate\", async (candidate: RTCIceCandidateInit) => {\r\n            if (pcRef.current) await pcRef.current.addIceCandidate(new RTCIceCandidate(candidate));\r\n        });\r\n\r\n        pc.createOffer().then((offer) => {\r\n            pc.setLocalDescription(offer);\r\n            socketRef.current?.emit(\"offer\", { sessionId: roomId, offer });\r\n        });\r\n\r\n        return () => {\r\n            pc.close();\r\n            if (videoRef.current) videoRef.current.srcObject = null;\r\n        };\r\n    }, [isStreaming, roomId]);\r\n\r\n    // --- Path / undo stack ---\r\n    const handlePathCreated = (path: FabricPath) => {\r\n        if (canvasRef.current && path) {\r\n            undoStack.current.push(path as unknown as FabricObject);\r\n            redoStack.current = [];\r\n            saveCanvasState(canvasRef.current, activePageId);\r\n        }\r\n    };\r\n\r\n    const handleUndo = () => {\r\n        if (!canvasRef.current) return;\r\n        const last = undoStack.current.pop();\r\n        if (last) {\r\n            redoStack.current.push(last);\r\n            canvasRef.current.remove(last);\r\n            canvasRef.current.requestRenderAll?.();\r\n            saveCanvasState(canvasRef.current, activePageId);\r\n        }\r\n    };\r\n\r\n    const handleRedo = () => {\r\n        if (!canvasRef.current) return;\r\n        const last = redoStack.current.pop();\r\n        if (last) {\r\n            undoStack.current.push(last);\r\n            canvasRef.current.add(last);\r\n            canvasRef.current.requestRenderAll?.();\r\n            saveCanvasState(canvasRef.current, activePageId);\r\n        }\r\n    };\r\n\r\n    const handleEnhance = () => toast.info(\"AI enhancement not implemented yet.\");\r\n\r\n    const copyLink = () => {\r\n        if (!viewUrl) return;\r\n        navigator.clipboard.writeText(viewUrl);\r\n        toast.success(\"View link copied to clipboard!\");\r\n    };\r\n\r\n    return (\r\n        <div className=\"relative w-screen h-screen bg-neutral-100 dark:bg-zinc-900\">\r\n            <header className=\"fixed top-0 left-0 right-0 h-14 z-40 flex items-center justify-between px-4 bg-white/80 dark:bg-zinc-900/80 backdrop-blur-md border-b border-gray-200 dark:border-zinc-700\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <h1 className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\">Bezalel Board</h1>\r\n                    <span className=\"text-xs text-gray-500 dark:text-gray-400\">/ {roomId}</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <input\r\n                        type=\"text\"\r\n                        value={viewUrl}\r\n                        readOnly\r\n                        className=\"text-xs text-gray-800 dark:text-gray-200 placeholder-gray-400 bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700 rounded-md px-2 py-1 w-64 focus:outline-none focus:ring-2 focus:ring-blue-400\"\r\n                        aria-label=\"view link\"\r\n                    />\r\n                    <button\r\n                        onClick={copyLink}\r\n                        className=\"inline-flex items-center gap-2 px-3 py-1 rounded-md bg-blue-600 text-white text-sm hover:bg-blue-700 transition\"\r\n                    >\r\n                        Copy\r\n                    </button>\r\n                    <div className=\"text-xs text-gray-600 dark:text-gray-400 px-2\">\r\n                        ðŸ‘€ {viewerCount} viewer{viewerCount === 1 ? \"\" : \"s\"}\r\n                    </div>\r\n                    <ThemeToggle />\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"absolute top-14 bottom-0 left-0 right-0 flex\">\r\n                <PageSidebar\r\n                    pages={pages}\r\n                    activePageId={activePageId}\r\n                    onSelectPage={setActivePageId}\r\n                    onAddPage={handleAddPage}\r\n                    onRenamePage={handleRenamePage}\r\n                    onDeletePage={handleDeletePage}\r\n                />\r\n\r\n                <div className=\"flex-1 flex items-center justify-center overflow-auto\">\r\n                    <Canvas\r\n                        ref={canvasComponentRef}\r\n                        isDrawingMode={isDrawingMode}\r\n                        setCanvasRef={(c) => (canvasRef.current = c)}\r\n                        onPathCreated={handlePathCreated}\r\n                        width={5000}\r\n                        height={3500}\r\n                        brushColor={brushColor}\r\n                        brushWidth={brushWidth}\r\n                        showGrid={showGrid}\r\n                    />\r\n                </div>\r\n\r\n                {isStreaming && (\r\n                    <aside className=\"w-64 p-3 border-l border-gray-100 bg-white/60 dark:bg-zinc-800/60\">\r\n                        <video ref={videoRef as any} autoPlay muted className=\"w-full h-40 rounded-md object-cover\" />\r\n                    </aside>\r\n                )}\r\n            </main>\r\n\r\n            <div className=\"fixed bottom-6 left-1/2 -translate-x-1/2 z-50\">\r\n                <div className=\"flex items-center gap-2 rounded-lg bg-white/95 dark:bg-zinc-800/95 backdrop-blur-md border border-gray-200 dark:border-zinc-700 shadow-md px-2 py-2\">\r\n                    <button\r\n                        title={isDrawingMode ? \"Drawing\" : \"Pan\"}\r\n                        onClick={() => setIsDrawingMode((s) => !s)}\r\n                        className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700 transition ${isDrawingMode ? \"bg-gray-100 dark:bg-zinc-700\" : \"\"}`}\r\n                    >\r\n                        {isDrawingMode ? <Pencil className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" /> : <Hand className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" />}\r\n                    </button>\r\n\r\n                    <input type=\"color\" value={brushColor} onChange={(e) => setBrushColor(e.target.value)} className=\"w-7 h-7 rounded-md border border-gray-200 dark:border-zinc-700\" title=\"Brush color\" />\r\n                    <input type=\"range\" min={1} max={40} value={brushWidth} onChange={(e) => setBrushWidth(Number(e.target.value))} className=\"w-24 accent-blue-500\" title=\"Brush size\" />\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-2\" />\r\n\r\n                    <button title=\"Undo\" onClick={handleUndo} className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700\">\r\n                        <Undo2 className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" />\r\n                    </button>\r\n                    <button title=\"Redo\" onClick={handleRedo} className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700\">\r\n                        <Redo2 className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" />\r\n                    </button>\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-2\" />\r\n\r\n                    <button title=\"Zoom Out\" onClick={() => canvasComponentRef.current?.zoomOut()} className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700\">\r\n                        <ZoomOut className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" />\r\n                    </button>\r\n                    <button title=\"Zoom In\" onClick={() => canvasComponentRef.current?.zoomIn()} className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700\">\r\n                        <ZoomIn className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" />\r\n                    </button>\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-2\" />\r\n\r\n                    <input\r\n                        title=\"AI prompt\"\r\n                        placeholder=\"AI prompt\"\r\n                        value={aiPrompt}\r\n                        onChange={(e) => setAiPrompt(e.target.value)}\r\n                        className=\"text-xs text-gray-800 dark:text-gray-200 placeholder-gray-400 bg-gray-50 dark:bg-zinc-700 border border-gray-200 dark:border-zinc-600 rounded-md px-2 py-1 w-44 focus:outline-none focus:ring-1 focus:ring-green-400\"\r\n                    />\r\n                    <button title=\"Enhance\" onClick={handleEnhance} className=\"p-2 rounded-md hover:bg-green-50\">\r\n                        <Sparkles className=\"w-4 h-4 text-green-600\" />\r\n                    </button>\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-2\" />\r\n\r\n                    <button\r\n                        title=\"Toggle grid\"\r\n                        onClick={() => setShowGrid((s) => !s)}\r\n                        className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700 transition ${showGrid ? \"bg-gray-100 dark:bg-zinc-700\" : \"\"}`}\r\n                    >\r\n                        <Grid className={`w-4 h-4 ${showGrid ? \"text-gray-800 dark:text-gray-200\" : \"text-gray-500 dark:text-zinc-400\"}`} />\r\n                    </button>\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-2\" />\r\n\r\n                    <label className=\"flex items-center gap-2 text-xs text-gray-700 dark:text-gray-300 cursor-pointer\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            checked={isStreaming}\r\n                            onChange={(e) => setIsStreaming(e.target.checked)}\r\n                            className=\"w-4 h-4 accent-blue-500\"\r\n                        />\r\n                        <Monitor className=\"w-4 h-4 text-gray-700 dark:text-gray-300\" />\r\n                    </label>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}