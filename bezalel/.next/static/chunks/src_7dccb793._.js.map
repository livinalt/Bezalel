{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/bridge/Bezalel/bezalel/src/components/Canvas.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useImperativeHandle, forwardRef } from \"react\";\r\nimport { Canvas as FabricJSCanvas, PencilBrush, Pattern, Path } from \"fabric\";\r\nimport { useTheme } from \"next-themes\";\r\n\r\ninterface CanvasProps {\r\n    isDrawingMode: boolean;\r\n    setCanvasRef?: (canvas: FabricJSCanvas | null) => void;\r\n    onPathCreated?: (path: Path) => void;\r\n    width?: number;\r\n    height?: number;\r\n    brushColor?: string;\r\n    brushWidth?: number;\r\n    showGrid?: boolean;\r\n}\r\n\r\nconst Canvas = forwardRef(function Canvas(\r\n    {\r\n        isDrawingMode,\r\n        setCanvasRef,\r\n        onPathCreated,\r\n        width = 5000,\r\n        height = 3500,\r\n        brushColor = \"#000000\",\r\n        brushWidth = 3,\r\n        showGrid = true,\r\n    }: CanvasProps,\r\n    ref\r\n) {\r\n    const canvasElRef = useRef<HTMLCanvasElement | null>(null);\r\n    const fabricRef = useRef<FabricJSCanvas | null>(null);\r\n    const patternCacheRef = useRef<HTMLCanvasElement | null>(null);\r\n    const { theme } = useTheme();\r\n\r\n    const setZoom = (zoom: number, point?: { x: number; y: number }) => {\r\n        if (!fabricRef.current) return;\r\n        if (!point) point = { x: fabricRef.current.getWidth()! / 2, y: fabricRef.current.getHeight()! / 2 };\r\n        fabricRef.current.zoomToPoint(point, zoom);\r\n    };\r\n\r\n    useImperativeHandle(ref, () => ({\r\n        zoomIn: () => fabricRef.current && setZoom(fabricRef.current.getZoom() * 1.1),\r\n        zoomOut: () => fabricRef.current && setZoom(fabricRef.current.getZoom() / 1.1),\r\n        resetZoom: () => fabricRef.current && setZoom(1),\r\n        toJSON: () => fabricRef.current?.toJSON(),\r\n        loadFromJSON: (json: any) => {\r\n            if (!fabricRef.current) return;\r\n            fabricRef.current.loadFromJSON(json || {}, () => fabricRef.current!.renderAll());\r\n        },\r\n    }));\r\n\r\n    useEffect(() => {\r\n        if (!canvasElRef.current) return;\r\n\r\n        const fcanvas = new FabricJSCanvas(canvasElRef.current, {\r\n            isDrawingMode,\r\n            width,\r\n            height,\r\n            selection: false,\r\n            backgroundColor: theme === \"dark\" ? \"#1a1a1a\" : \"#ffffff\",\r\n        });\r\n\r\n        fabricRef.current = fcanvas;\r\n\r\n        fcanvas.freeDrawingBrush = new PencilBrush(fcanvas);\r\n        fcanvas.freeDrawingBrush.width = brushWidth;\r\n        fcanvas.freeDrawingBrush.color = brushColor;\r\n\r\n        if (onPathCreated) {\r\n            fcanvas.on(\"path:created\", (opts: any) => {\r\n                const path = opts.path as Path | undefined;\r\n                if (path) onPathCreated(path);\r\n            });\r\n        }\r\n\r\n        // grid\r\n        const makeGridPattern = () => {\r\n            const gridSize = 40;\r\n            const gridCanvas = document.createElement(\"canvas\");\r\n            gridCanvas.width = gridSize;\r\n            gridCanvas.height = gridSize;\r\n            const ctx = gridCanvas.getContext(\"2d\");\r\n            if (ctx) {\r\n                ctx.clearRect(0, 0, gridSize, gridSize);\r\n                ctx.fillStyle = theme === \"dark\" ? \"rgba(255,255,255,0.06)\" : \"rgba(0,0,0,0.06)\";\r\n                ctx.beginPath();\r\n                ctx.arc(gridSize / 2, gridSize / 2, 0.8, 0, Math.PI * 2);\r\n                ctx.fill();\r\n            }\r\n            return gridCanvas;\r\n        };\r\n\r\n        patternCacheRef.current = makeGridPattern();\r\n\r\n        if (showGrid && patternCacheRef.current) {\r\n            fcanvas.set(\"backgroundColor\", new Pattern({ source: patternCacheRef.current, repeat: \"repeat\" }));\r\n        }\r\n\r\n        if (setCanvasRef) setCanvasRef(fcanvas);\r\n\r\n        const wheelHandler = (opt: WheelEvent) => {\r\n            if (!fabricRef.current) return;\r\n            if (!(opt.ctrlKey || opt.metaKey)) return;\r\n            opt.preventDefault();\r\n            let zoom = fabricRef.current.getZoom();\r\n            zoom *= 0.999 ** opt.deltaY;\r\n            zoom = Math.min(Math.max(zoom, 0.2), 4);\r\n            setZoom(zoom, { x: opt.offsetX, y: opt.offsetY });\r\n        };\r\n\r\n        canvasElRef.current?.addEventListener(\"wheel\", wheelHandler, { passive: false });\r\n\r\n        return () => {\r\n            fcanvas.dispose();\r\n            if (setCanvasRef) setCanvasRef(null);\r\n            canvasElRef.current?.removeEventListener(\"wheel\", wheelHandler);\r\n        };\r\n    }, []);\r\n\r\n    // dynamic updates\r\n    useEffect(() => {\r\n        if (fabricRef.current) fabricRef.current.isDrawingMode = isDrawingMode;\r\n    }, [isDrawingMode]);\r\n\r\n    useEffect(() => {\r\n        if (fabricRef.current?.freeDrawingBrush) fabricRef.current.freeDrawingBrush.color = brushColor;\r\n    }, [brushColor]);\r\n\r\n    useEffect(() => {\r\n        if (fabricRef.current?.freeDrawingBrush) fabricRef.current.freeDrawingBrush.width = brushWidth;\r\n    }, [brushWidth]);\r\n\r\n    useEffect(() => {\r\n        if (!fabricRef.current) return;\r\n        if (showGrid && patternCacheRef.current) {\r\n            fabricRef.current.set(\"backgroundColor\", new Pattern({ source: patternCacheRef.current, repeat: \"repeat\" }));\r\n        } else {\r\n            fabricRef.current.set(\"backgroundColor\", theme === \"dark\" ? \"#1a1a1a\" : \"#ffffff\");\r\n        }\r\n        fabricRef.current.renderAll();\r\n    }, [showGrid, theme]);\r\n\r\n    return (\r\n        <div className=\"w-full h-full flex justify-center items-center overflow-auto p-6\">\r\n            <canvas\r\n                ref={canvasElRef}\r\n                width={width}\r\n                height={height}\r\n                className=\"block rounded-xl border border-gray-200 shadow-inner\"\r\n                aria-label=\"drawing-canvas\"\r\n            />\r\n        </div>\r\n    );\r\n});\r\n\r\nexport default Canvas;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 216, "column": 0}, "map": {"version":3,"sources":["file:///C:/bridge/Bezalel/bezalel/src/components/PageSidebar.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { Plus, Trash2, ChevronLeft, ChevronRight } from \"lucide-react\";\r\n\r\ninterface PageData {\r\n    id: string;\r\n    name: string;\r\n    canvasData: any;\r\n}\r\n\r\ninterface SidebarProps {\r\n    pages: PageData[];\r\n    activePageId: string;\r\n    onSelectPage: (id: string) => void;\r\n    onAddPage: () => void;\r\n    onRenamePage: (id: string, newName: string) => void;\r\n    onDeletePage: (id: string) => void;\r\n}\r\n\r\nexport default function PageSidebar({\r\n    pages,\r\n    activePageId,\r\n    onSelectPage,\r\n    onAddPage,\r\n    onRenamePage,\r\n    onDeletePage,\r\n}: SidebarProps) {\r\n    const [collapsed, setCollapsed] = useState(false);\r\n    const [editingId, setEditingId] = useState<string | null>(null);\r\n    const [editValue, setEditValue] = useState(\"\");\r\n\r\n    return (\r\n        <aside className={`h-full border-r border-gray-200 bg-gray-50 dark:bg-zinc-900 transition-all duration-300 ${collapsed ? \"w-14\" : \"w-56\"}`}>\r\n            {/* Collapse toggle */}\r\n            <div className=\"flex items-center justify-between p-2 border-b border-gray-200 dark:border-zinc-700\">\r\n                {!collapsed && <span className=\"text-xs font-semibold text-gray-600 dark:text-gray-300\">Pages</span>}\r\n                <button onClick={() => setCollapsed(!collapsed)} className=\"p-1 hover:bg-gray-200 dark:hover:bg-zinc-700 rounded-md\">\r\n                    {collapsed ? <ChevronRight className=\"w-4 h-4 text-gray-600 dark:text-gray-300\" /> : <ChevronLeft className=\"w-4 h-4 text-gray-600 dark:text-gray-300\" />}\r\n                </button>\r\n            </div>\r\n\r\n            {/* Add Page button (always visible at top) */}\r\n            {!collapsed && (\r\n                <div className=\"p-2 border-b border-gray-200 dark:border-zinc-700\">\r\n                    <button\r\n                        onClick={onAddPage}\r\n                        className=\"w-full flex items-center gap-1 justify-center px-2 py-1 text-sm bg-gray-200 dark:bg-zinc-800 hover:bg-gray-300 dark:hover:bg-zinc-700 rounded-md\"\r\n                    >\r\n                        <Plus className=\"w-4 h-4\" /> New Page\r\n                    </button>\r\n                </div>\r\n            )}\r\n\r\n            {/* Pages list */}\r\n            <ul className=\"overflow-y-auto\" style={{ maxHeight: \"calc(100% - 3.5rem)\" }}>\r\n                {pages.map((page) => (\r\n                    <li\r\n                        key={page.id}\r\n                        className={`group flex items-center justify-between px-2 py-1 cursor-pointer text-sm ${activePageId === page.id ? \"bg-gray-200 font-bold dark:bg-zinc-800\" : \"hover:bg-gray-100 dark:hover:bg-zinc-700\"}`}\r\n                        onClick={() => onSelectPage(page.id)}\r\n                        onDoubleClick={() => {\r\n                            setEditingId(page.id);\r\n                            setEditValue(page.name);\r\n                        }}\r\n                    >\r\n                        {editingId === page.id ? (\r\n                            <input\r\n                                value={editValue}\r\n                                onChange={(e) => setEditValue(e.target.value)}\r\n                                onBlur={() => {\r\n                                    onRenamePage(page.id, editValue.trim() || \"Untitled\");\r\n                                    setEditingId(null);\r\n                                }}\r\n                                onKeyDown={(e) => {\r\n                                    if (e.key === \"Enter\") {\r\n                                        onRenamePage(page.id, editValue.trim() || \"Untitled\");\r\n                                        setEditingId(null);\r\n                                    }\r\n                                }}\r\n                                autoFocus\r\n                                className=\"flex-1 bg-white dark:bg-zinc-800 border border-gray-300 dark:border-zinc-700 rounded px-1 text-sm\"\r\n                            />\r\n                        ) : (\r\n                            <span className=\"truncate flex-1\">{page.name}</span>\r\n                        )}\r\n                        {!collapsed && (\r\n                            <button\r\n                                onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                    onDeletePage(page.id);\r\n                                }}\r\n                                className=\"opacity-0 group-hover:opacity-100 p-1 hover:bg-red-100 dark:hover:bg-red-900 rounded-md\"\r\n                            >\r\n                                <Trash2 className=\"w-4 h-4 text-red-500\" />\r\n                            </button>\r\n                        )}\r\n                    </li>\r\n                ))}\r\n            </ul>\r\n        </aside>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;;;AAHA;;;AAoBe,SAAS,YAAY,KAOrB;QAPqB,EAChC,KAAK,EACL,YAAY,EACZ,YAAY,EACZ,SAAS,EACT,YAAY,EACZ,YAAY,EACD,GAPqB;;IAQhC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAgB;IAC1D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,qBACI,6LAAC;QAAM,WAAW,AAAC,2FAAsH,OAA5B,YAAY,SAAS;;0BAE9H,6LAAC;gBAAI,WAAU;;oBACV,CAAC,2BAAa,6LAAC;wBAAK,WAAU;kCAAyD;;;;;;kCACxF,6LAAC;wBAAO,SAAS,IAAM,aAAa,CAAC;wBAAY,WAAU;kCACtD,0BAAY,6LAAC,yOAAY;4BAAC,WAAU;;;;;iDAAgD,6LAAC,sOAAW;4BAAC,WAAU;;;;;;;;;;;;;;;;;YAKnH,CAAC,2BACE,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBACG,SAAS;oBACT,WAAU;;sCAEV,6LAAC,6MAAI;4BAAC,WAAU;;;;;;wBAAY;;;;;;;;;;;;0BAMxC,6LAAC;gBAAG,WAAU;gBAAkB,OAAO;oBAAE,WAAW;gBAAsB;0BACrE,MAAM,GAAG,CAAC,CAAC,qBACR,6LAAC;wBAEG,WAAW,AAAC,4EAA4L,OAAjH,iBAAiB,KAAK,EAAE,GAAG,2CAA2C;wBAC7J,SAAS,IAAM,aAAa,KAAK,EAAE;wBACnC,eAAe;4BACX,aAAa,KAAK,EAAE;4BACpB,aAAa,KAAK,IAAI;wBAC1B;;4BAEC,cAAc,KAAK,EAAE,iBAClB,6LAAC;gCACG,OAAO;gCACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;gCAC5C,QAAQ;oCACJ,aAAa,KAAK,EAAE,EAAE,UAAU,IAAI,MAAM;oCAC1C,aAAa;gCACjB;gCACA,WAAW,CAAC;oCACR,IAAI,EAAE,GAAG,KAAK,SAAS;wCACnB,aAAa,KAAK,EAAE,EAAE,UAAU,IAAI,MAAM;wCAC1C,aAAa;oCACjB;gCACJ;gCACA,SAAS;gCACT,WAAU;;;;;qDAGd,6LAAC;gCAAK,WAAU;0CAAmB,KAAK,IAAI;;;;;;4BAE/C,CAAC,2BACE,6LAAC;gCACG,SAAS,CAAC;oCACN,EAAE,eAAe;oCACjB,aAAa,KAAK,EAAE;gCACxB;gCACA,WAAU;0CAEV,cAAA,6LAAC,uNAAM;oCAAC,WAAU;;;;;;;;;;;;uBApCrB,KAAK,EAAE;;;;;;;;;;;;;;;;AA4CpC;GAlFwB;KAAA","debugId":null}},
    {"offset": {"line": 390, "column": 0}, "map": {"version":3,"sources":["file:///C:/bridge/Bezalel/bezalel/src/components/ThemeToggle.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useTheme } from \"next-themes\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { Sun, Moon } from \"lucide-react\";\r\n\r\nexport default function ThemeToggle() {\r\n    const { theme, setTheme } = useTheme();\r\n    const [mounted, setMounted] = useState(false);\r\n\r\n    useEffect(() => setMounted(true), []);\r\n    if (!mounted) return null; // avoid hydration mismatch\r\n\r\n    const toggleTheme = () => {\r\n        setTheme(theme === \"dark\" ? \"light\" : \"dark\");\r\n    };\r\n\r\n    return (\r\n        <button\r\n            onClick={toggleTheme}\r\n            aria-label=\"Toggle theme\"\r\n            aria-pressed={theme === \"dark\"}\r\n            title={`Switch to ${theme === \"dark\" ? \"light\" : \"dark\"} mode`}\r\n            className=\"relative flex items-center justify-center p-2 rounded-full \r\n                 bg-gray-100 hover:bg-gray-200 \r\n                 dark:bg-zinc-800 dark:hover:bg-zinc-700\r\n                 transition-all shadow-sm hover:shadow-md\"\r\n        >\r\n            {/* Icon wrapper with animation */}\r\n            <span className=\"absolute transition-transform duration-300 ease-in-out transform \r\n                       rotate-0 opacity-100 dark:-rotate-90 dark:opacity-0\">\r\n                <Sun className=\"w-5 h-5 text-yellow-500\" />\r\n            </span>\r\n            <span className=\"absolute transition-transform duration-300 ease-in-out transform \r\n                       rotate-90 opacity-0 dark:rotate-0 dark:opacity-100\">\r\n                <Moon className=\"w-5 h-5 text-gray-200\" />\r\n            </span>\r\n        </button>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;;;AAJA;;;;AAMe,SAAS;;IACpB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,IAAA,+JAAQ;IACpC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;iCAAC,IAAM,WAAW;gCAAO,EAAE;IACpC,IAAI,CAAC,SAAS,OAAO,MAAM,2BAA2B;IAEtD,MAAM,cAAc;QAChB,SAAS,UAAU,SAAS,UAAU;IAC1C;IAEA,qBACI,6LAAC;QACG,SAAS;QACT,cAAW;QACX,gBAAc,UAAU;QACxB,OAAO,AAAC,aAAgD,OAApC,UAAU,SAAS,UAAU,QAAO;QACxD,WAAU;;0BAMV,6LAAC;gBAAK,WAAU;0BAEZ,cAAA,6LAAC,0MAAG;oBAAC,WAAU;;;;;;;;;;;0BAEnB,6LAAC;gBAAK,WAAU;0BAEZ,cAAA,6LAAC,6MAAI;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAIhC;GAjCwB;;QACQ,+JAAQ;;;KADhB","debugId":null}},
    {"offset": {"line": 473, "column": 0}, "map": {"version":3,"sources":["file:///C:/bridge/Bezalel/bezalel/src/app/board/%5BroomId%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { useParams } from \"next/navigation\";\r\nimport io, { Socket } from \"socket.io-client\";\r\nimport { debounce } from \"lodash\";\r\nimport Canvas from \"@/components/Canvas\";\r\nimport { Canvas as FabricJSCanvas, Object as FabricObject, Path as FabricPath } from \"fabric\";\r\nimport { toast } from \"sonner\";\r\nimport { Pencil, Hand, Undo2, Redo2, Sparkles, Monitor, Grid, ZoomIn, ZoomOut } from \"lucide-react\";\r\nimport PageSidebar from \"@/components/PageSidebar\";\r\nimport { v4 as uuid } from \"uuid\";\r\nimport ThemeToggle from \"@/components/ThemeToggle\";\r\n\r\ntype PageData = {\r\n    id: string;\r\n    name: string;\r\n    canvasData: any | null;\r\n};\r\n\r\nexport default function Board() {\r\n    const { roomId } = useParams();\r\n    const canvasRef = useRef<FabricJSCanvas | null>(null);\r\n    const socketRef = useRef<Socket | null>(null);\r\n    const pcRef = useRef<RTCPeerConnection | null>(null);\r\n    const videoRef = useRef<HTMLVideoElement | null>(null);\r\n    const canvasComponentRef = useRef<any>(null);\r\n\r\n    const [isStreaming, setIsStreaming] = useState(false);\r\n    const [viewerCount, setViewerCount] = useState(0);\r\n    const [aiPrompt, setAiPrompt] = useState(\"\");\r\n    const [isDrawingMode, setIsDrawingMode] = useState(true);\r\n    const [brushColor, setBrushColor] = useState(\"#000000\");\r\n    const [brushWidth, setBrushWidth] = useState(3);\r\n    const [viewUrl, setViewUrl] = useState(\"\");\r\n    const [showGrid, setShowGrid] = useState(true);\r\n\r\n    const undoStack = useRef<FabricObject[]>([]);\r\n    const redoStack = useRef<FabricObject[]>([]);\r\n\r\n    const [pages, setPages] = useState<PageData[]>([{ id: uuid(), name: \"Page 1\", canvasData: null }]);\r\n    const [activePageId, setActivePageId] = useState(pages[0].id);\r\n\r\n    // --- Page management ---\r\n    const handleAddPage = () => {\r\n        const newPage = { id: uuid(), name: `Page ${pages.length + 1}`, canvasData: null };\r\n        setPages((prev) => [...prev, newPage]);\r\n        setActivePageId(newPage.id);\r\n    };\r\n\r\n    const handleRenamePage = (id: string, newName: string) => {\r\n        if (newName.trim() === '') return;\r\n        setPages((prev) => prev.map((p) => (p.id === id ? { ...p, name: newName } : p)));\r\n    };\r\n\r\n    const handleDeletePage = (id: string) => {\r\n        if (pages.length === 1) {\r\n            toast.error(\"Cannot delete the last page.\");\r\n            return;\r\n        }\r\n        setPages((prev) => {\r\n            const remaining = prev.filter((p) => p.id !== id);\r\n            if (activePageId === id) {\r\n                setActivePageId(remaining[0].id);\r\n            }\r\n            return remaining;\r\n        });\r\n    };\r\n\r\n    // --- Save canvas state ---\r\n    const saveCanvasState = debounce((canvas: FabricJSCanvas, pageId: string) => {\r\n        setPages((prevPages) =>\r\n            prevPages.map((p) =>\r\n                p.id === pageId ? { ...p, canvasData: canvas.toJSON(['selectable', 'id']) } : p\r\n            )\r\n        );\r\n    }, 500);\r\n\r\n    useEffect(() => {\r\n        if (!canvasRef.current) return;\r\n\r\n        const handleCanvasChange = () => {\r\n            saveCanvasState(canvasRef.current!, activePageId);\r\n        };\r\n\r\n        canvasRef.current.on(\"object:added\", handleCanvasChange);\r\n        canvasRef.current.on(\"object:modified\", handleCanvasChange);\r\n        canvasRef.current.on(\"object:removed\", handleCanvasChange);\r\n\r\n        return () => {\r\n            canvasRef.current?.off(\"object:added\", handleCanvasChange);\r\n            canvasRef.current?.off(\"object:modified\", handleCanvasChange);\r\n            canvasRef.current?.off(\"object:removed\", handleCanvasChange);\r\n        };\r\n    }, [activePageId]);\r\n\r\n    // --- Load page canvas ---\r\n    useEffect(() => {\r\n        if (!canvasRef.current) return;\r\n\r\n        const activePage = pages.find((p) => p.id === activePageId);\r\n        if (!activePage) return;\r\n\r\n        // Clear canvas and reset stacks\r\n        canvasRef.current.clear();\r\n        undoStack.current = [];\r\n        redoStack.current = [];\r\n\r\n        // Load page data\r\n        if (activePage.canvasData) {\r\n            canvasRef.current.loadFromJSON(activePage.canvasData, () => {\r\n                canvasRef.current!.renderAll();\r\n            });\r\n        } else {\r\n            canvasRef.current.renderAll();\r\n        }\r\n    }, [activePageId]);\r\n\r\n    // --- Safe window usage ---\r\n    useEffect(() => {\r\n        if (typeof window !== \"undefined\") {\r\n            setViewUrl(`${window.location.origin}/board/${roomId}/view`);\r\n        }\r\n    }, [roomId]);\r\n\r\n    // --- Socket.io setup ---\r\n    useEffect(() => {\r\n        const socket = io(process.env.NEXT_PUBLIC_SIGNALING_URL || \"http://localhost:3000\");\r\n        socketRef.current = socket;\r\n        socket.on(\"connect\", () => socket.emit(\"joinSession\", roomId));\r\n        socket.on(\"viewerCount\", (count: number) => setViewerCount(count));\r\n        return () => socket.disconnect();\r\n    }, [roomId]);\r\n\r\n    // --- WebRTC streaming ---\r\n    useEffect(() => {\r\n        if (!isStreaming || !canvasRef.current || !videoRef.current) return;\r\n        const pc = new RTCPeerConnection({ iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }] });\r\n        pcRef.current = pc;\r\n\r\n        const canvasElement = (canvasRef.current as any).lowerCanvasEl ?? (canvasRef.current as any).getElement?.();\r\n        if (!canvasElement || typeof canvasElement.captureStream !== \"function\") {\r\n            toast.error(\"Streaming not supported: unable to capture canvas stream.\");\r\n            return;\r\n        }\r\n\r\n        const canvasStream = canvasElement.captureStream(30);\r\n        navigator.mediaDevices\r\n            .getUserMedia({ video: true, audio: true })\r\n            .then((webcamStream) => {\r\n                const combined = new MediaStream();\r\n                canvasStream.getVideoTracks().forEach((t) => combined.addTrack(t));\r\n                webcamStream.getVideoTracks().forEach((t) => combined.addTrack(t));\r\n                webcamStream.getAudioTracks().forEach((t) => combined.addTrack(t));\r\n                combined.getTracks().forEach((t) => pc.addTrack(t, combined));\r\n                videoRef.current!.srcObject = combined;\r\n            })\r\n            .catch(() => {\r\n                toast.error(\"Could not access webcam — streaming canvas only.\");\r\n                canvasStream.getTracks().forEach((t) => pc.addTrack(t, canvasStream));\r\n            });\r\n\r\n        pc.onicecandidate = (ev) => {\r\n            if (ev.candidate) socketRef.current?.emit(\"ice-candidate\", { sessionId: roomId, candidate: ev.candidate });\r\n        };\r\n\r\n        socketRef.current?.on(\"answer\", async (answer: RTCSessionDescriptionInit) => {\r\n            await pc.setRemoteDescription(new RTCSessionDescription(answer));\r\n        });\r\n\r\n        socketRef.current?.on(\"ice-candidate\", async (candidate: RTCIceCandidateInit) => {\r\n            if (pcRef.current) await pcRef.current.addIceCandidate(new RTCIceCandidate(candidate));\r\n        });\r\n\r\n        pc.createOffer().then((offer) => {\r\n            pc.setLocalDescription(offer);\r\n            socketRef.current?.emit(\"offer\", { sessionId: roomId, offer });\r\n        });\r\n\r\n        return () => {\r\n            pc.close();\r\n            if (videoRef.current) videoRef.current.srcObject = null;\r\n        };\r\n    }, [isStreaming, roomId]);\r\n\r\n    // --- Path / undo stack ---\r\n    const handlePathCreated = (path: FabricPath) => {\r\n        if (canvasRef.current && path) {\r\n            undoStack.current.push(path as unknown as FabricObject);\r\n            redoStack.current = [];\r\n            saveCanvasState(canvasRef.current, activePageId);\r\n        }\r\n    };\r\n\r\n    const handleUndo = () => {\r\n        if (!canvasRef.current) return;\r\n        const last = undoStack.current.pop();\r\n        if (last) {\r\n            redoStack.current.push(last);\r\n            canvasRef.current.remove(last);\r\n            canvasRef.current.requestRenderAll?.();\r\n            saveCanvasState(canvasRef.current, activePageId);\r\n        }\r\n    };\r\n\r\n    const handleRedo = () => {\r\n        if (!canvasRef.current) return;\r\n        const last = redoStack.current.pop();\r\n        if (last) {\r\n            undoStack.current.push(last);\r\n            canvasRef.current.add(last);\r\n            canvasRef.current.requestRenderAll?.();\r\n            saveCanvasState(canvasRef.current, activePageId);\r\n        }\r\n    };\r\n\r\n    const handleEnhance = () => toast.info(\"AI enhancement not implemented yet.\");\r\n\r\n    const copyLink = () => {\r\n        if (!viewUrl) return;\r\n        navigator.clipboard.writeText(viewUrl);\r\n        toast.success(\"View link copied to clipboard!\");\r\n    };\r\n\r\n    return (\r\n        <div className=\"relative w-screen h-screen bg-neutral-100 dark:bg-zinc-900\">\r\n            <header className=\"fixed top-0 left-0 right-0 h-14 z-40 flex items-center justify-between px-4 bg-white/80 dark:bg-zinc-900/80 backdrop-blur-md border-b border-gray-200 dark:border-zinc-700\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <h1 className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\">Bezalel Board</h1>\r\n                    <span className=\"text-xs text-gray-500 dark:text-gray-400\">/ {roomId}</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <input\r\n                        type=\"text\"\r\n                        value={viewUrl}\r\n                        readOnly\r\n                        className=\"text-xs text-gray-800 dark:text-gray-200 placeholder-gray-400 bg-gray-50 dark:bg-zinc-800 border border-gray-200 dark:border-zinc-700 rounded-md px-2 py-1 w-64 focus:outline-none focus:ring-2 focus:ring-blue-400\"\r\n                        aria-label=\"view link\"\r\n                    />\r\n                    <button\r\n                        onClick={copyLink}\r\n                        className=\"inline-flex items-center gap-2 px-3 py-1 rounded-md bg-blue-600 text-white text-sm hover:bg-blue-700 transition\"\r\n                    >\r\n                        Copy\r\n                    </button>\r\n                    <div className=\"text-xs text-gray-600 dark:text-gray-400 px-2\">\r\n                        👀 {viewerCount} viewer{viewerCount === 1 ? \"\" : \"s\"}\r\n                    </div>\r\n                    <ThemeToggle />\r\n                </div>\r\n            </header>\r\n\r\n            <main className=\"absolute top-14 bottom-0 left-0 right-0 flex\">\r\n                <PageSidebar\r\n                    pages={pages}\r\n                    activePageId={activePageId}\r\n                    onSelectPage={setActivePageId}\r\n                    onAddPage={handleAddPage}\r\n                    onRenamePage={handleRenamePage}\r\n                    onDeletePage={handleDeletePage}\r\n                />\r\n\r\n                <div className=\"flex-1 flex items-center justify-center overflow-auto\">\r\n                    <Canvas\r\n                        ref={canvasComponentRef}\r\n                        isDrawingMode={isDrawingMode}\r\n                        setCanvasRef={(c) => (canvasRef.current = c)}\r\n                        onPathCreated={handlePathCreated}\r\n                        width={5000}\r\n                        height={3500}\r\n                        brushColor={brushColor}\r\n                        brushWidth={brushWidth}\r\n                        showGrid={showGrid}\r\n                    />\r\n                </div>\r\n\r\n                {isStreaming && (\r\n                    <aside className=\"w-64 p-3 border-l border-gray-100 bg-white/60 dark:bg-zinc-800/60\">\r\n                        <video ref={videoRef as any} autoPlay muted className=\"w-full h-40 rounded-md object-cover\" />\r\n                    </aside>\r\n                )}\r\n            </main>\r\n\r\n            <div className=\"fixed bottom-6 left-1/2 -translate-x-1/2 z-50\">\r\n                <div className=\"flex items-center gap-2 rounded-lg bg-white/95 dark:bg-zinc-800/95 backdrop-blur-md border border-gray-200 dark:border-zinc-700 shadow-md px-2 py-2\">\r\n                    <button\r\n                        title={isDrawingMode ? \"Drawing\" : \"Pan\"}\r\n                        onClick={() => setIsDrawingMode((s) => !s)}\r\n                        className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700 transition ${isDrawingMode ? \"bg-gray-100 dark:bg-zinc-700\" : \"\"}`}\r\n                    >\r\n                        {isDrawingMode ? <Pencil className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" /> : <Hand className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" />}\r\n                    </button>\r\n\r\n                    <input type=\"color\" value={brushColor} onChange={(e) => setBrushColor(e.target.value)} className=\"w-7 h-7 rounded-md border border-gray-200 dark:border-zinc-700\" title=\"Brush color\" />\r\n                    <input type=\"range\" min={1} max={40} value={brushWidth} onChange={(e) => setBrushWidth(Number(e.target.value))} className=\"w-24 accent-blue-500\" title=\"Brush size\" />\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-2\" />\r\n\r\n                    <button title=\"Undo\" onClick={handleUndo} className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700\">\r\n                        <Undo2 className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" />\r\n                    </button>\r\n                    <button title=\"Redo\" onClick={handleRedo} className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700\">\r\n                        <Redo2 className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" />\r\n                    </button>\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-2\" />\r\n\r\n                    <button title=\"Zoom Out\" onClick={() => canvasComponentRef.current?.zoomOut()} className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700\">\r\n                        <ZoomOut className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" />\r\n                    </button>\r\n                    <button title=\"Zoom In\" onClick={() => canvasComponentRef.current?.zoomIn()} className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700\">\r\n                        <ZoomIn className=\"w-4 h-4 text-gray-800 dark:text-gray-200\" />\r\n                    </button>\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-2\" />\r\n\r\n                    <input\r\n                        title=\"AI prompt\"\r\n                        placeholder=\"AI prompt\"\r\n                        value={aiPrompt}\r\n                        onChange={(e) => setAiPrompt(e.target.value)}\r\n                        className=\"text-xs text-gray-800 dark:text-gray-200 placeholder-gray-400 bg-gray-50 dark:bg-zinc-700 border border-gray-200 dark:border-zinc-600 rounded-md px-2 py-1 w-44 focus:outline-none focus:ring-1 focus:ring-green-400\"\r\n                    />\r\n                    <button title=\"Enhance\" onClick={handleEnhance} className=\"p-2 rounded-md hover:bg-green-50\">\r\n                        <Sparkles className=\"w-4 h-4 text-green-600\" />\r\n                    </button>\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-2\" />\r\n\r\n                    <button\r\n                        title=\"Toggle grid\"\r\n                        onClick={() => setShowGrid((s) => !s)}\r\n                        className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-zinc-700 transition ${showGrid ? \"bg-gray-100 dark:bg-zinc-700\" : \"\"}`}\r\n                    >\r\n                        <Grid className={`w-4 h-4 ${showGrid ? \"text-gray-800 dark:text-gray-200\" : \"text-gray-500 dark:text-zinc-400\"}`} />\r\n                    </button>\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 dark:bg-zinc-700 mx-2\" />\r\n\r\n                    <label className=\"flex items-center gap-2 text-xs text-gray-700 dark:text-gray-300 cursor-pointer\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            checked={isStreaming}\r\n                            onChange={(e) => setIsStreaming(e.target.checked)}\r\n                            className=\"w-4 h-4 accent-blue-500\"\r\n                        />\r\n                        <Monitor className=\"w-4 h-4 text-gray-700 dark:text-gray-300\" />\r\n                    </label>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}