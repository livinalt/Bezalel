{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/bridge/Bezalel/bezalel/src/components/Canvas.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useImperativeHandle, forwardRef } from \"react\";\r\nimport {\r\n    Canvas as FabricJSCanvas,\r\n    PencilBrush,\r\n    Pattern,\r\n    Path,\r\n} from \"fabric\";\r\n\r\ninterface CanvasProps {\r\n    isDrawingMode: boolean;\r\n    setCanvasRef?: (canvas: FabricJSCanvas | null) => void;\r\n    onPathCreated?: (path: Path) => void;\r\n    width?: number;\r\n    height?: number;\r\n    brushColor?: string;\r\n    brushWidth?: number;\r\n    showGrid?: boolean;\r\n}\r\n\r\n// ForwardRef so parent (Board) can call zoomIn/zoomOut\r\nconst Canvas = forwardRef(function Canvas(\r\n    {\r\n        isDrawingMode,\r\n        setCanvasRef,\r\n        onPathCreated,\r\n        width = 5000,\r\n        height = 3500,\r\n        brushColor = \"#000000\",\r\n        brushWidth = 3,\r\n        showGrid = true,\r\n    }: CanvasProps,\r\n    ref\r\n) {\r\n    const canvasElRef = useRef<HTMLCanvasElement | null>(null);\r\n    const fabricRef = useRef<FabricJSCanvas | null>(null);\r\n    const patternCacheRef = useRef<HTMLCanvasElement | null>(null);\r\n\r\n    // --- helper: apply zoom ---\r\n    const setZoom = (zoom: number, point?: { x: number; y: number }) => {\r\n        if (!fabricRef.current) return;\r\n        const canvas = fabricRef.current;\r\n        if (!point) {\r\n            point = { x: canvas.getWidth()! / 2, y: canvas.getHeight()! / 2 };\r\n        }\r\n        canvas.zoomToPoint(point, zoom);\r\n    };\r\n\r\n    // Expose zoom methods to parent\r\n    useImperativeHandle(ref, () => ({\r\n        zoomIn: () => {\r\n            if (fabricRef.current) {\r\n                const zoom = fabricRef.current.getZoom() * 1.1;\r\n                setZoom(Math.min(zoom, 4));\r\n            }\r\n        },\r\n        zoomOut: () => {\r\n            if (fabricRef.current) {\r\n                const zoom = fabricRef.current.getZoom() / 1.1;\r\n                setZoom(Math.max(zoom, 0.2));\r\n            }\r\n        },\r\n        resetZoom: () => {\r\n            if (fabricRef.current) {\r\n                setZoom(1);\r\n            }\r\n        },\r\n    }));\r\n\r\n    // Initialize Fabric canvas (once)\r\n    useEffect(() => {\r\n        if (!canvasElRef.current) return;\r\n\r\n        const fcanvas = new FabricJSCanvas(canvasElRef.current, {\r\n            isDrawingMode,\r\n            width,\r\n            height,\r\n            selection: false,\r\n            backgroundColor: \"#ffffff\",\r\n        });\r\n\r\n        fabricRef.current = fcanvas;\r\n\r\n        fcanvas.freeDrawingBrush = new PencilBrush(fcanvas);\r\n        fcanvas.freeDrawingBrush.width = brushWidth;\r\n        fcanvas.freeDrawingBrush.color = brushColor;\r\n\r\n        if (onPathCreated) {\r\n            fcanvas.on(\"path:created\", (opts: any) => {\r\n                const path = opts.path as Path | undefined;\r\n                if (path) onPathCreated(path);\r\n            });\r\n        }\r\n\r\n        // Make subtle dot grid\r\n        const makeGridPattern = () => {\r\n            const gridSize = 40;\r\n            const gridCanvas = document.createElement(\"canvas\");\r\n            gridCanvas.width = gridSize;\r\n            gridCanvas.height = gridSize;\r\n            const ctx = gridCanvas.getContext(\"2d\");\r\n            if (ctx) {\r\n                ctx.clearRect(0, 0, gridSize, gridSize);\r\n                ctx.fillStyle = \"rgba(0,0,0,0.06)\";\r\n                ctx.beginPath();\r\n                ctx.arc(gridSize / 2, gridSize / 2, 0.8, 0, Math.PI * 2);\r\n                ctx.fill();\r\n            }\r\n            return gridCanvas;\r\n        };\r\n        patternCacheRef.current = makeGridPattern();\r\n\r\n        if (showGrid && patternCacheRef.current) {\r\n            fcanvas.set(\"backgroundColor\", new Pattern({ source: patternCacheRef.current, repeat: \"repeat\" }));\r\n        }\r\n\r\n        if (setCanvasRef) setCanvasRef(fcanvas);\r\n\r\n        // --- Zoom with Ctrl + Scroll ---\r\n        const wheelHandler = (opt: WheelEvent) => {\r\n            if (!fabricRef.current) return;\r\n            if (!(opt.ctrlKey || opt.metaKey)) return; // only when holding ctrl/cmd\r\n            opt.preventDefault();\r\n\r\n            let zoom = fabricRef.current.getZoom();\r\n            zoom *= 0.999 ** opt.deltaY; // smooth zoom\r\n            zoom = Math.min(Math.max(zoom, 0.2), 4); // clamp\r\n            const point = { x: opt.offsetX, y: opt.offsetY };\r\n            setZoom(zoom, point);\r\n        };\r\n\r\n        canvasElRef.current?.addEventListener(\"wheel\", wheelHandler, { passive: false });\r\n\r\n        return () => {\r\n            fcanvas.dispose();\r\n            if (setCanvasRef) setCanvasRef(null);\r\n            canvasElRef.current?.removeEventListener(\"wheel\", wheelHandler);\r\n        };\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    // update brush & mode dynamically\r\n    useEffect(() => {\r\n        if (fabricRef.current) fabricRef.current.isDrawingMode = isDrawingMode;\r\n    }, [isDrawingMode]);\r\n    useEffect(() => {\r\n        if (fabricRef.current?.freeDrawingBrush) fabricRef.current.freeDrawingBrush.color = brushColor;\r\n    }, [brushColor]);\r\n    useEffect(() => {\r\n        if (fabricRef.current?.freeDrawingBrush) fabricRef.current.freeDrawingBrush.width = brushWidth ?? 3;\r\n    }, [brushWidth]);\r\n    useEffect(() => {\r\n        if (!fabricRef.current) return;\r\n        if (showGrid && patternCacheRef.current) {\r\n            fabricRef.current.set(\"backgroundColor\", new Pattern({ source: patternCacheRef.current, repeat: \"repeat\" }));\r\n        } else {\r\n            fabricRef.current.set(\"backgroundColor\", \"#ffffff\");\r\n        }\r\n        fabricRef.current.renderAll();\r\n    }, [showGrid]);\r\n\r\n    return (\r\n        <div className=\"w-full h-full flex justify-center items-center overflow-auto p-6\">\r\n            <canvas\r\n                ref={canvasElRef}\r\n                width={width}\r\n                height={height}\r\n                className=\"block rounded-xl border border-gray-200 shadow-inner\"\r\n                aria-label=\"drawing-canvas\"\r\n            />\r\n        </div>\r\n    );\r\n});\r\n\r\nexport default Canvas;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 214, "column": 0}, "map": {"version":3,"sources":["file:///C:/bridge/Bezalel/bezalel/src/components/PageSidebar.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { Plus, Trash2, ChevronLeft, ChevronRight } from \"lucide-react\";\r\n\r\ninterface PageData {\r\n    id: string;\r\n    name: string;\r\n    canvasData: any;\r\n}\r\n\r\ninterface SidebarProps {\r\n    pages: PageData[];\r\n    activePageId: string;\r\n    onSelectPage: (id: string) => void;\r\n    onAddPage: () => void;\r\n    onRenamePage: (id: string, newName: string) => void;\r\n    onDeletePage: (id: string) => void;\r\n}\r\n\r\nexport default function PageSidebar({\r\n    pages,\r\n    activePageId,\r\n    onSelectPage,\r\n    onAddPage,\r\n    onRenamePage,\r\n    onDeletePage,\r\n}: SidebarProps) {\r\n    const [collapsed, setCollapsed] = useState(false);\r\n    const [editingId, setEditingId] = useState<string | null>(null);\r\n    const [editValue, setEditValue] = useState(\"\");\r\n\r\n    return (\r\n        <aside\r\n            className={`h-full border-r border-gray-300 bg-gray-100 transition-all duration-300\r\n        ${collapsed ? \"w-14\" : \"w-56\"}`}\r\n        >\r\n            {/* Collapse toggle */}\r\n            <div className=\"flex items-center justify-between p-2 border-b border-gray-300\">\r\n                {!collapsed && (\r\n                    <span className=\"text-[13px] font-semibold text-gray-800 uppercase tracking-wide\">\r\n                        Pages\r\n                    </span>\r\n                )}\r\n                <button\r\n                    onClick={() => setCollapsed(!collapsed)}\r\n                    className=\"p-1 hover:bg-gray-200 rounded-md\"\r\n                >\r\n                    {collapsed ? (\r\n                        <ChevronRight className=\"w-4 h-4 text-gray-700\" />\r\n                    ) : (\r\n                        <ChevronLeft className=\"w-4 h-4 text-gray-700\" />\r\n                    )}\r\n                </button>\r\n            </div>\r\n\r\n            {/* Pages list */}\r\n            <ul className=\"overflow-y-auto h-[calc(100%-3rem)]\">\r\n                {pages.map((page) => (\r\n                    <li\r\n                        key={page.id}\r\n                        className={`group flex items-center justify-between px-3 py-1.5 cursor-pointer text-[13px]\r\n              ${activePageId === page.id\r\n                                ? \"bg-gray-200 font-semibold text-gray-900 border-l-2 border-blue-500\"\r\n                                : \"hover:bg-gray-200 text-gray-800\"\r\n                            }`}\r\n                        onClick={() => onSelectPage(page.id)}\r\n                        onDoubleClick={() => {\r\n                            setEditingId(page.id);\r\n                            setEditValue(page.name);\r\n                        }}\r\n                    >\r\n                        {editingId === page.id ? (\r\n                            <input\r\n                                value={editValue}\r\n                                onChange={(e) => setEditValue(e.target.value)}\r\n                                onBlur={() => {\r\n                                    onRenamePage(page.id, editValue.trim() || \"Untitled\");\r\n                                    setEditingId(null);\r\n                                }}\r\n                                onKeyDown={(e) => {\r\n                                    if (e.key === \"Enter\") {\r\n                                        onRenamePage(page.id, editValue.trim() || \"Untitled\");\r\n                                        setEditingId(null);\r\n                                    }\r\n                                }}\r\n                                autoFocus\r\n                                className=\"flex-1 bg-white border border-gray-300 rounded px-1 text-[13px] text-gray-900\"\r\n                            />\r\n                        ) : (\r\n                            <span className=\"truncate flex-1\">{page.name}</span>\r\n                        )}\r\n                        {!collapsed && (\r\n                            <button\r\n                                onClick={(e) => {\r\n                                    e.stopPropagation();\r\n                                    onDeletePage(page.id);\r\n                                }}\r\n                                className=\"opacity-0 group-hover:opacity-100 p-1 hover:bg-red-100 rounded-md\"\r\n                            >\r\n                                <Trash2 className=\"w-4 h-4 text-gray-500 hover:text-red-600\" />\r\n                            </button>\r\n                        )}\r\n                    </li>\r\n                ))}\r\n            </ul>\r\n\r\n            {/* Add page button */}\r\n            {!collapsed && (\r\n                <div className=\"p-2 border-t border-gray-300\">\r\n                    <button\r\n                        onClick={onAddPage}\r\n                        className=\"w-full flex items-center gap-1 justify-center px-2 py-1.5 text-[13px] bg-gray-200 hover:bg-gray-300 rounded-md text-gray-800 font-medium\"\r\n                    >\r\n                        <Plus className=\"w-4 h-4\" /> New Page\r\n                    </button>\r\n                </div>\r\n            )}\r\n        </aside>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;;;AAHA;;;AAoBe,SAAS,YAAY,KAOrB;QAPqB,EAChC,KAAK,EACL,YAAY,EACZ,YAAY,EACZ,SAAS,EACT,YAAY,EACZ,YAAY,EACD,GAPqB;;IAQhC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAgB;IAC1D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,qBACI,6LAAC;QACG,WAAW,AAAC,oFACc,OAA5B,YAAY,SAAS;;0BAGnB,6LAAC;gBAAI,WAAU;;oBACV,CAAC,2BACE,6LAAC;wBAAK,WAAU;kCAAkE;;;;;;kCAItF,6LAAC;wBACG,SAAS,IAAM,aAAa,CAAC;wBAC7B,WAAU;kCAET,0BACG,6LAAC,yOAAY;4BAAC,WAAU;;;;;iDAExB,6LAAC,sOAAW;4BAAC,WAAU;;;;;;;;;;;;;;;;;0BAMnC,6LAAC;gBAAG,WAAU;0BACT,MAAM,GAAG,CAAC,CAAC,qBACR,6LAAC;wBAEG,WAAW,AAAC,iGAIP,OAHb,iBAAiB,KAAK,EAAE,GACN,uEACA;wBAEV,SAAS,IAAM,aAAa,KAAK,EAAE;wBACnC,eAAe;4BACX,aAAa,KAAK,EAAE;4BACpB,aAAa,KAAK,IAAI;wBAC1B;;4BAEC,cAAc,KAAK,EAAE,iBAClB,6LAAC;gCACG,OAAO;gCACP,UAAU,CAAC,IAAM,aAAa,EAAE,MAAM,CAAC,KAAK;gCAC5C,QAAQ;oCACJ,aAAa,KAAK,EAAE,EAAE,UAAU,IAAI,MAAM;oCAC1C,aAAa;gCACjB;gCACA,WAAW,CAAC;oCACR,IAAI,EAAE,GAAG,KAAK,SAAS;wCACnB,aAAa,KAAK,EAAE,EAAE,UAAU,IAAI,MAAM;wCAC1C,aAAa;oCACjB;gCACJ;gCACA,SAAS;gCACT,WAAU;;;;;qDAGd,6LAAC;gCAAK,WAAU;0CAAmB,KAAK,IAAI;;;;;;4BAE/C,CAAC,2BACE,6LAAC;gCACG,SAAS,CAAC;oCACN,EAAE,eAAe;oCACjB,aAAa,KAAK,EAAE;gCACxB;gCACA,WAAU;0CAEV,cAAA,6LAAC,uNAAM;oCAAC,WAAU;;;;;;;;;;;;uBAxCrB,KAAK,EAAE;;;;;;;;;;YAgDvB,CAAC,2BACE,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBACG,SAAS;oBACT,WAAU;;sCAEV,6LAAC,6MAAI;4BAAC,WAAU;;;;;;wBAAY;;;;;;;;;;;;;;;;;;AAMpD;GApGwB;KAAA","debugId":null}},
    {"offset": {"line": 385, "column": 0}, "map": {"version":3,"sources":["file:///C:/bridge/Bezalel/bezalel/src/app/board/%5BroomId%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { useParams } from \"next/navigation\";\r\nimport io, { Socket } from \"socket.io-client\";\r\nimport Canvas from \"@/components/Canvas\";\r\nimport { Canvas as FabricJSCanvas, Object as FabricObject, Path as FabricPath } from \"fabric\";\r\nimport { toast } from \"sonner\";\r\nimport { Pencil, Hand, Undo2, Redo2, Sparkles, Monitor, Grid, ZoomIn, ZoomOut } from \"lucide-react\";\r\nimport PageSidebar from \"@/components/PageSidebar\";\r\nimport { v4 as uuid } from \"uuid\";\r\nimport ThemeToggle from \"@/components/ThemeToggle\"; // ✅ import it\r\n\r\n// --- Types ---\r\ntype PageData = {\r\n    id: string;\r\n    name: string;\r\n    canvasData: any | null;\r\n};\r\n\r\n\r\n\r\nexport default function Board() {\r\n    const { roomId } = useParams();\r\n    const canvasRef = useRef<FabricJSCanvas | null>(null);\r\n    const socketRef = useRef<Socket | null>(null);\r\n    const pcRef = useRef<RTCPeerConnection | null>(null);\r\n    const videoRef = useRef<HTMLVideoElement | null>(null);\r\n\r\n    // UI / drawing state\r\n    const [isStreaming, setIsStreaming] = useState(false);\r\n    const [viewerCount, setViewerCount] = useState(0);\r\n    const [aiPrompt, setAiPrompt] = useState(\"\");\r\n    const [isDrawingMode, setIsDrawingMode] = useState(true);\r\n    const [brushColor, setBrushColor] = useState(\"#000000\");\r\n    const [brushWidth, setBrushWidth] = useState(3);\r\n    const [viewUrl, setViewUrl] = useState(\"\"); // set only on client\r\n    const [showGrid, setShowGrid] = useState(true); // Figma-style grid toggle\r\n\r\n    const canvasComponentRef = useRef<any>(null);\r\n\r\n    // Undo / redo stacks (store Fabric objects)\r\n    const undoStack = useRef<FabricObject[]>([]);\r\n    const redoStack = useRef<FabricObject[]>([]);\r\n\r\n    // Pages state\r\n    const [pages, setPages] = useState<PageData[]>(() => [\r\n        { id: uuid(), name: \"Page 1\", canvasData: null },\r\n    ]);\r\n\r\n    const [activePageId, setActivePageId] = useState(() => pages[0].id);\r\n\r\n\r\n    // --- Page management handlers ---\r\n\r\n    const handleAddPage = () => {\r\n        const newPage = { id: uuid(), name: `Page ${pages.length + 1}`, canvasData: null };\r\n        setPages((prev) => [...prev, newPage]);\r\n        setActivePageId(newPage.id);\r\n    };\r\n\r\n    const handleRenamePage = (id: string, newName: string) => {\r\n        setPages((prev) =>\r\n            prev.map((p) => (p.id === id ? { ...p, name: newName } : p))\r\n        );\r\n    };\r\n\r\n    const handleDeletePage = (id: string) => {\r\n        if (pages.length === 1) return; // ❗ keep at least one page\r\n        setPages((prev) => prev.filter((p) => p.id !== id));\r\n\r\n        if (activePageId === id) {\r\n            const remaining = pages.filter((p) => p.id !== id);\r\n            if (remaining.length > 0) {\r\n                setActivePageId(remaining[0].id);\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n\r\n\r\n    // --- Safe window usage (SSR-safe) ---\r\n    useEffect(() => {\r\n        if (typeof window !== \"undefined\") {\r\n            setViewUrl(`${window.location.origin}/board/${roomId}/view`);\r\n        }\r\n    }, [roomId]);\r\n\r\n    // --- Socket.io setup ---\r\n    useEffect(() => {\r\n        const socket = io(process.env.NEXT_PUBLIC_SIGNALING_URL || \"http://localhost:3000\");\r\n        socketRef.current = socket;\r\n\r\n        socket.on(\"connect\", () => {\r\n            socket.emit(\"joinSession\", roomId);\r\n        });\r\n\r\n        socket.on(\"viewerCount\", (count: number) => {\r\n            setViewerCount(count);\r\n        });\r\n\r\n        return () => {\r\n            socket.disconnect();\r\n        };\r\n    }, [roomId]);\r\n\r\n    // --- WebRTC streaming (canvas + optional webcam) ---\r\n    useEffect(() => {\r\n        if (!isStreaming || !canvasRef.current || !videoRef.current) return;\r\n\r\n        const pc = new RTCPeerConnection({\r\n            iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }],\r\n        });\r\n        pcRef.current = pc;\r\n\r\n        // get actual canvas element (some Fabric versions expose lowerCanvasEl)\r\n        const canvasElement =\r\n            // @ts-expect-error - try known properties\r\n            (canvasRef.current as any).lowerCanvasEl ?? (canvasRef.current as any).getElement?.();\r\n\r\n        if (!canvasElement || typeof canvasElement.captureStream !== \"function\") {\r\n            toast.error(\"Streaming not supported: unable to capture canvas stream.\");\r\n            return;\r\n        }\r\n\r\n        const canvasStream = canvasElement.captureStream(30);\r\n\r\n        navigator.mediaDevices\r\n            .getUserMedia({ video: true, audio: true })\r\n            .then((webcamStream) => {\r\n                const combined = new MediaStream();\r\n                canvasStream.getVideoTracks().forEach((t) => combined.addTrack(t));\r\n                webcamStream.getVideoTracks().forEach((t) => combined.addTrack(t));\r\n                webcamStream.getAudioTracks().forEach((t) => combined.addTrack(t));\r\n\r\n                combined.getTracks().forEach((t) => pc.addTrack(t, combined));\r\n                videoRef.current!.srcObject = combined;\r\n            })\r\n            .catch((err) => {\r\n                console.error(\"webcam error\", err);\r\n                toast.error(\"Could not access webcam — streaming canvas only.\");\r\n                canvasStream.getTracks().forEach((t) => pc.addTrack(t, canvasStream));\r\n            });\r\n\r\n        pc.onicecandidate = (ev) => {\r\n            if (ev.candidate) {\r\n                socketRef.current?.emit(\"ice-candidate\", { sessionId: roomId, candidate: ev.candidate });\r\n            }\r\n        };\r\n\r\n        socketRef.current?.on(\"answer\", async (answer: RTCSessionDescriptionInit) => {\r\n            await pc.setRemoteDescription(new RTCSessionDescription(answer));\r\n        });\r\n\r\n        socketRef.current?.on(\"ice-candidate\", async (candidate: RTCIceCandidateInit) => {\r\n            if (pcRef.current) {\r\n                await pcRef.current.addIceCandidate(new RTCIceCandidate(candidate));\r\n            }\r\n        });\r\n\r\n        pc.createOffer().then((offer) => {\r\n            pc.setLocalDescription(offer);\r\n            socketRef.current?.emit(\"offer\", { sessionId: roomId, offer });\r\n        });\r\n\r\n        return () => {\r\n            pc.close();\r\n            // ✅ Safe cleanup to avoid null crash\r\n            if (videoRef.current) {\r\n                videoRef.current.srcObject = null;\r\n            }\r\n        };\r\n    }, [isStreaming, roomId]);\r\n\r\n    // --- Path created (for undo stack) ---\r\n    const handlePathCreated = (path: FabricPath) => {\r\n        if (canvasRef.current && path) {\r\n            undoStack.current.push(path as unknown as FabricObject);\r\n            redoStack.current = [];\r\n        }\r\n    };\r\n\r\n    // Undo / Redo\r\n    const handleUndo = () => {\r\n        if (!canvasRef.current) return;\r\n        const last = undoStack.current.pop();\r\n        if (last) {\r\n            redoStack.current.push(last);\r\n            canvasRef.current.remove(last);\r\n            canvasRef.current.requestRenderAll?.();\r\n        }\r\n    };\r\n    const handleRedo = () => {\r\n        if (!canvasRef.current) return;\r\n        const last = redoStack.current.pop();\r\n        if (last) {\r\n            undoStack.current.push(last);\r\n            canvasRef.current.add(last);\r\n            canvasRef.current.requestRenderAll?.();\r\n        }\r\n    };\r\n\r\n    const handleEnhance = () => {\r\n        toast.info(\"AI enhancement not implemented yet.\");\r\n    };\r\n\r\n    const copyLink = () => {\r\n        if (!viewUrl) return;\r\n        navigator.clipboard.writeText(viewUrl);\r\n        toast.success(\"View link copied to clipboard!\");\r\n    };\r\n\r\n    return (\r\n        <div className=\"relative w-screen h-screen bg-neutral-100\">\r\n            {/* --- Header (slim Figma-style) --- */}\r\n            <header className=\"fixed top-0 left-0 right-0 h-14 z-40 flex items-center justify-between px-4 bg-white/80 backdrop-blur-md border-b border-gray-200\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <h1 className=\"text-sm font-semibold text-gray-800\">Bezalel Board</h1>\r\n                    <span className=\"text-xs text-gray-500\">/ {roomId}</span>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-2\">\r\n                    <input\r\n                        type=\"text\"\r\n                        value={viewUrl}\r\n                        readOnly\r\n                        className=\"text-xs text-gray-800 placeholder-gray-400 bg-gray-50 border border-gray-200 rounded-md px-2 py-1 w-64 focus:outline-none focus:ring-2 focus:ring-blue-400\"\r\n                        aria-label=\"view link\"\r\n                    />\r\n                    <button\r\n                        onClick={copyLink}\r\n                        className=\"inline-flex items-center gap-2 px-3 py-1 rounded-md bg-blue-600 text-white text-sm hover:bg-blue-700 transition\"\r\n                    >\r\n                        Copy\r\n                    </button>\r\n\r\n                    <div className=\"text-xs text-gray-600 px-2\">👀 {viewerCount} viewer{viewerCount === 1 ? \"\" : \"s\"}</div>\r\n                </div>\r\n            </header>\r\n\r\n            {/* --- Main area: occupies rest of viewport under header --- */}\r\n            <main className=\"absolute top-14 bottom-0 left-0 right-0 flex\">\r\n                {/* // Sidebar (left) */}\r\n                <PageSidebar\r\n                    pages={pages}\r\n                    activePageId={activePageId}\r\n                    onSelectPage={setActivePageId}\r\n                    onAddPage={handleAddPage}\r\n                    onRenamePage={handleRenamePage}\r\n                    onDeletePage={handleDeletePage}\r\n                />\r\n\r\n                {/* Canvas pane (center) */}\r\n                <div className=\"flex-1 flex items-center justify-center overflow-auto\">\r\n                    <Canvas\r\n                        ref={canvasComponentRef}\r\n                        isDrawingMode={isDrawingMode}\r\n                        setCanvasRef={(c) => (canvasRef.current = c)}\r\n                        onPathCreated={handlePathCreated}\r\n                        width={5000}\r\n                        height={3500}\r\n                        brushColor={brushColor}\r\n                        brushWidth={brushWidth}\r\n                        showGrid={showGrid}\r\n                    />\r\n                </div>\r\n\r\n                {/* optional picture-in-picture preview */}\r\n                {isStreaming && (\r\n                    <aside className=\"w-64 p-3 border-l border-gray-100 bg-white/60\">\r\n                        <video ref={videoRef as any} autoPlay muted className=\"w-full h-40 rounded-md object-cover\" />\r\n                    </aside>\r\n                )}\r\n            </main>\r\n\r\n            {/* --- Floating toolbar (bottom center) Figma-style slim --- */}\r\n            <div className=\"fixed bottom-6 left-1/2 -translate-x-1/2 z-50\">\r\n                <div className=\"flex items-center gap-2 rounded-lg bg-white/95 backdrop-blur-md border border-gray-200 shadow-md px-2 py-2\">\r\n                    {/* Draw / Pan toggle */}\r\n                    <button\r\n                        title={isDrawingMode ? \"Drawing\" : \"Pan\"}\r\n                        onClick={() => setIsDrawingMode((s) => !s)}\r\n                        className={`p-2 rounded-md hover:bg-gray-100 transition ${isDrawingMode ? \"bg-gray-100\" : \"\"}`}\r\n                    >\r\n                        {isDrawingMode ? <Pencil className=\"w-4 h-4 text-gray-800\" /> : <Hand className=\"w-4 h-4 text-gray-800\" />}\r\n                    </button>\r\n\r\n                    {/* Color */}\r\n                    <input\r\n                        title=\"Brush color\"\r\n                        type=\"color\"\r\n                        value={brushColor}\r\n                        onChange={(e) => setBrushColor(e.target.value)}\r\n                        className=\"w-7 h-7 rounded-md border border-gray-200\"\r\n                    />\r\n\r\n                    {/* Width slider (compact) */}\r\n                    <input\r\n                        title=\"Brush size\"\r\n                        type=\"range\"\r\n                        min={1}\r\n                        max={40}\r\n                        value={brushWidth}\r\n                        onChange={(e) => setBrushWidth(Number(e.target.value))}\r\n                        className=\"w-24 accent-blue-500\"\r\n                    />\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 mx-2\" />\r\n\r\n                    {/* Undo / Redo controls */}\r\n                    <button title=\"Undo\" onClick={handleUndo} className=\"p-2 rounded-md hover:bg-gray-100\">\r\n                        <Undo2 className=\"w-4 h-4 text-gray-800\" />\r\n                    </button>\r\n                    <button title=\"Redo\" onClick={handleRedo} className=\"p-2 rounded-md hover:bg-gray-100\">\r\n                        <Redo2 className=\"w-4 h-4 text-gray-800\" />\r\n                    </button>\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 mx-2\" />\r\n\r\n                    {/* inside zoom in and out controls*/}\r\n                    <button\r\n                        title=\"Zoom Out\"\r\n                        onClick={() => canvasComponentRef.current?.zoomOut()}\r\n                        className=\"p-2 rounded-md hover:bg-gray-100\"\r\n                    >\r\n                        <ZoomOut className=\"w-4 h-4 text-gray-800\" />\r\n                    </button>\r\n                    <button\r\n                        title=\"Zoom In\"\r\n                        onClick={() => canvasComponentRef.current?.zoomIn()}\r\n                        className=\"p-2 rounded-md hover:bg-gray-100\"\r\n                    >\r\n                        <ZoomIn className=\"w-4 h-4 text-gray-800\" />\r\n                    </button>\r\n\r\n                    {/* AI prompt + enhance */}\r\n                    <input\r\n                        title=\"AI prompt\"\r\n                        placeholder=\"AI prompt\"\r\n                        value={aiPrompt}\r\n                        onChange={(e) => setAiPrompt(e.target.value)}\r\n                        className=\"text-xs text-gray-800 placeholder-gray-400 bg-gray-50 border border-gray-200 rounded-md px-2 py-1 w-44 focus:outline-none focus:ring-1 focus:ring-green-400\"\r\n                    />\r\n                    <button title=\"Enhance\" onClick={handleEnhance} className=\"p-2 rounded-md hover:bg-green-50\">\r\n                        <Sparkles className=\"w-4 h-4 text-green-600\" />\r\n                    </button>\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 mx-2\" />\r\n\r\n                    {/* Grid toggle (Figma-style) */}\r\n                    <button\r\n                        title=\"Toggle grid\"\r\n                        onClick={() => setShowGrid((s) => !s)}\r\n                        className={`p-2 rounded-md hover:bg-gray-100 transition ${showGrid ? \"bg-gray-100\" : \"\"}`}\r\n                    >\r\n                        <Grid className={`w-4 h-4 ${showGrid ? \"text-gray-800\" : \"text-gray-500\"}`} />\r\n                    </button>\r\n\r\n                    <div className=\"w-px h-6 bg-gray-200 mx-2\" />\r\n\r\n                    {/* Streaming toggle */}\r\n                    <label className=\"flex items-center gap-2 text-xs text-gray-700 cursor-pointer\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            checked={isStreaming}\r\n                            onChange={(e) => setIsStreaming(e.target.checked)}\r\n                            className=\"w-4 h-4 accent-blue-500\"\r\n                        />\r\n                        <Monitor className=\"w-4 h-4 text-gray-700\" />\r\n                    </label>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;AA2F0B;;AAzF1B;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;;AAVA;;;;;;;;;AAsBe,SAAS;;IACpB,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,kJAAS;IAC5B,MAAM,YAAY,IAAA,uKAAM,EAAwB;IAChD,MAAM,YAAY,IAAA,uKAAM,EAAgB;IACxC,MAAM,QAAQ,IAAA,uKAAM,EAA2B;IAC/C,MAAM,WAAW,IAAA,uKAAM,EAA0B;IAEjD,qBAAqB;IACrB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,yKAAQ,EAAC;IAC7C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC,KAAK,qBAAqB;IACjE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC,OAAO,0BAA0B;IAE1E,MAAM,qBAAqB,IAAA,uKAAM,EAAM;IAEvC,4CAA4C;IAC5C,MAAM,YAAY,IAAA,uKAAM,EAAiB,EAAE;IAC3C,MAAM,YAAY,IAAA,uKAAM,EAAiB,EAAE;IAE3C,cAAc;IACd,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ;0BAAa,IAAM;gBACjD;oBAAE,IAAI,IAAA,8LAAI;oBAAI,MAAM;oBAAU,YAAY;gBAAK;aAClD;;IAED,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ;0BAAC,IAAM,KAAK,CAAC,EAAE,CAAC,EAAE;;IAGlE,mCAAmC;IAEnC,MAAM,gBAAgB;QAClB,MAAM,UAAU;YAAE,IAAI,IAAA,8LAAI;YAAI,MAAM,AAAC,QAAwB,OAAjB,MAAM,MAAM,GAAG;YAAK,YAAY;QAAK;QACjF,SAAS,CAAC,OAAS;mBAAI;gBAAM;aAAQ;QACrC,gBAAgB,QAAQ,EAAE;IAC9B;IAEA,MAAM,mBAAmB,CAAC,IAAY;QAClC,SAAS,CAAC,OACN,KAAK,GAAG,CAAC,CAAC,IAAO,EAAE,EAAE,KAAK,KAAK;oBAAE,GAAG,CAAC;oBAAE,MAAM;gBAAQ,IAAI;IAEjE;IAEA,MAAM,mBAAmB,CAAC;QACtB,IAAI,MAAM,MAAM,KAAK,GAAG,QAAQ,2BAA2B;QAC3D,SAAS,CAAC,OAAS,KAAK,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;QAE/C,IAAI,iBAAiB,IAAI;YACrB,MAAM,YAAY,MAAM,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;YAC/C,IAAI,UAAU,MAAM,GAAG,GAAG;gBACtB,gBAAgB,SAAS,CAAC,EAAE,CAAC,EAAE;YACnC;QACJ;IACJ;IAKA,uCAAuC;IACvC,IAAA,0KAAS;2BAAC;YACN,wCAAmC;gBAC/B,WAAW,AAAC,GAAkC,OAAhC,OAAO,QAAQ,CAAC,MAAM,EAAC,WAAgB,OAAP,QAAO;YACzD;QACJ;0BAAG;QAAC;KAAO;IAEX,0BAA0B;IAC1B,IAAA,0KAAS;2BAAC;YACN,MAAM,SAAS,IAAA,6LAAE,EAAC,2KAAO,CAAC,GAAG,CAAC,yBAAyB,IAAI;YAC3D,UAAU,OAAO,GAAG;YAEpB,OAAO,EAAE,CAAC;mCAAW;oBACjB,OAAO,IAAI,CAAC,eAAe;gBAC/B;;YAEA,OAAO,EAAE,CAAC;mCAAe,CAAC;oBACtB,eAAe;gBACnB;;YAEA;mCAAO;oBACH,OAAO,UAAU;gBACrB;;QACJ;0BAAG;QAAC;KAAO;IAEX,sDAAsD;IACtD,IAAA,0KAAS;2BAAC;gBAW0C,aAAA,OAgChD,oBAIA;YA9CA,IAAI,CAAC,eAAe,CAAC,UAAU,OAAO,IAAI,CAAC,SAAS,OAAO,EAAE;YAE7D,MAAM,KAAK,IAAI,kBAAkB;gBAC7B,YAAY;oBAAC;wBAAE,MAAM;oBAA+B;iBAAE;YAC1D;YACA,MAAM,OAAO,GAAG;gBAIZ,0CAA0C;YAC1C;YAHJ,wEAAwE;YACxE,MAAM,gBAEF,CAAA,iBAAA,AAAC,UAAU,OAAO,CAAS,aAAa,cAAxC,4BAAA,kBAA4C,cAAA,CAAA,QAAC,UAAU,OAAO,EAAS,UAAU,cAArC,kCAAA,iBAAA;YAEhD,IAAI,CAAC,iBAAiB,OAAO,cAAc,aAAa,KAAK,YAAY;gBACrE,oJAAK,CAAC,KAAK,CAAC;gBACZ;YACJ;YAEA,MAAM,eAAe,cAAc,aAAa,CAAC;YAEjD,UAAU,YAAY,CACjB,YAAY,CAAC;gBAAE,OAAO;gBAAM,OAAO;YAAK,GACxC,IAAI;mCAAC,CAAC;oBACH,MAAM,WAAW,IAAI;oBACrB,aAAa,cAAc,GAAG,OAAO;2CAAC,CAAC,IAAM,SAAS,QAAQ,CAAC;;oBAC/D,aAAa,cAAc,GAAG,OAAO;2CAAC,CAAC,IAAM,SAAS,QAAQ,CAAC;;oBAC/D,aAAa,cAAc,GAAG,OAAO;2CAAC,CAAC,IAAM,SAAS,QAAQ,CAAC;;oBAE/D,SAAS,SAAS,GAAG,OAAO;2CAAC,CAAC,IAAM,GAAG,QAAQ,CAAC,GAAG;;oBACnD,SAAS,OAAO,CAAE,SAAS,GAAG;gBAClC;kCACC,KAAK;mCAAC,CAAC;oBACJ,QAAQ,KAAK,CAAC,gBAAgB;oBAC9B,oJAAK,CAAC,KAAK,CAAC;oBACZ,aAAa,SAAS,GAAG,OAAO;2CAAC,CAAC,IAAM,GAAG,QAAQ,CAAC,GAAG;;gBAC3D;;YAEJ,GAAG,cAAc;mCAAG,CAAC;oBACjB,IAAI,GAAG,SAAS,EAAE;4BACd;yBAAA,qBAAA,UAAU,OAAO,cAAjB,yCAAA,mBAAmB,IAAI,CAAC,iBAAiB;4BAAE,WAAW;4BAAQ,WAAW,GAAG,SAAS;wBAAC;oBAC1F;gBACJ;;aAEA,qBAAA,UAAU,OAAO,cAAjB,yCAAA,mBAAmB,EAAE,CAAC;mCAAU,OAAO;oBACnC,MAAM,GAAG,oBAAoB,CAAC,IAAI,sBAAsB;gBAC5D;;aAEA,sBAAA,UAAU,OAAO,cAAjB,0CAAA,oBAAmB,EAAE,CAAC;mCAAiB,OAAO;oBAC1C,IAAI,MAAM,OAAO,EAAE;wBACf,MAAM,MAAM,OAAO,CAAC,eAAe,CAAC,IAAI,gBAAgB;oBAC5D;gBACJ;;YAEA,GAAG,WAAW,GAAG,IAAI;mCAAC,CAAC;wBAEnB;oBADA,GAAG,mBAAmB,CAAC;qBACvB,qBAAA,UAAU,OAAO,cAAjB,yCAAA,mBAAmB,IAAI,CAAC,SAAS;wBAAE,WAAW;wBAAQ;oBAAM;gBAChE;;YAEA;mCAAO;oBACH,GAAG,KAAK;oBACR,qCAAqC;oBACrC,IAAI,SAAS,OAAO,EAAE;wBAClB,SAAS,OAAO,CAAC,SAAS,GAAG;oBACjC;gBACJ;;QACJ;0BAAG;QAAC;QAAa;KAAO;IAExB,wCAAwC;IACxC,MAAM,oBAAoB,CAAC;QACvB,IAAI,UAAU,OAAO,IAAI,MAAM;YAC3B,UAAU,OAAO,CAAC,IAAI,CAAC;YACvB,UAAU,OAAO,GAAG,EAAE;QAC1B;IACJ;IAEA,cAAc;IACd,MAAM,aAAa;QACf,IAAI,CAAC,UAAU,OAAO,EAAE;QACxB,MAAM,OAAO,UAAU,OAAO,CAAC,GAAG;QAClC,IAAI,MAAM;gBAGN,qCAAA;YAFA,UAAU,OAAO,CAAC,IAAI,CAAC;YACvB,UAAU,OAAO,CAAC,MAAM,CAAC;aACzB,sCAAA,CAAA,qBAAA,UAAU,OAAO,EAAC,gBAAgB,cAAlC,0DAAA,yCAAA;QACJ;IACJ;IACA,MAAM,aAAa;QACf,IAAI,CAAC,UAAU,OAAO,EAAE;QACxB,MAAM,OAAO,UAAU,OAAO,CAAC,GAAG;QAClC,IAAI,MAAM;gBAGN,qCAAA;YAFA,UAAU,OAAO,CAAC,IAAI,CAAC;YACvB,UAAU,OAAO,CAAC,GAAG,CAAC;aACtB,sCAAA,CAAA,qBAAA,UAAU,OAAO,EAAC,gBAAgB,cAAlC,0DAAA,yCAAA;QACJ;IACJ;IAEA,MAAM,gBAAgB;QAClB,oJAAK,CAAC,IAAI,CAAC;IACf;IAEA,MAAM,WAAW;QACb,IAAI,CAAC,SAAS;QACd,UAAU,SAAS,CAAC,SAAS,CAAC;QAC9B,oJAAK,CAAC,OAAO,CAAC;IAClB;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BAEX,6LAAC;gBAAO,WAAU;;kCACd,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAG,WAAU;0CAAsC;;;;;;0CACpD,6LAAC;gCAAK,WAAU;;oCAAwB;oCAAG;;;;;;;;;;;;;kCAG/C,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCACG,MAAK;gCACL,OAAO;gCACP,QAAQ;gCACR,WAAU;gCACV,cAAW;;;;;;0CAEf,6LAAC;gCACG,SAAS;gCACT,WAAU;0CACb;;;;;;0CAID,6LAAC;gCAAI,WAAU;;oCAA6B;oCAAI;oCAAY;oCAAQ,gBAAgB,IAAI,KAAK;;;;;;;;;;;;;;;;;;;0BAKrG,6LAAC;gBAAK,WAAU;;kCAEZ,6LAAC,+IAAW;wBACR,OAAO;wBACP,cAAc;wBACd,cAAc;wBACd,WAAW;wBACX,cAAc;wBACd,cAAc;;;;;;kCAIlB,6LAAC;wBAAI,WAAU;kCACX,cAAA,6LAAC,0IAAM;4BACH,KAAK;4BACL,eAAe;4BACf,cAAc,CAAC,IAAO,UAAU,OAAO,GAAG;4BAC1C,eAAe;4BACf,OAAO;4BACP,QAAQ;4BACR,YAAY;4BACZ,YAAY;4BACZ,UAAU;;;;;;;;;;;oBAKjB,6BACG,6LAAC;wBAAM,WAAU;kCACb,cAAA,6LAAC;4BAAM,KAAK;4BAAiB,QAAQ;4BAAC,KAAK;4BAAC,WAAU;;;;;;;;;;;;;;;;;0BAMlE,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBAAI,WAAU;;sCAEX,6LAAC;4BACG,OAAO,gBAAgB,YAAY;4BACnC,SAAS,IAAM,iBAAiB,CAAC,IAAM,CAAC;4BACxC,WAAW,AAAC,+CAAiF,OAAnC,gBAAgB,gBAAgB;sCAEzF,8BAAgB,6LAAC,mNAAM;gCAAC,WAAU;;;;;qDAA6B,6LAAC,6MAAI;gCAAC,WAAU;;;;;;;;;;;sCAIpF,6LAAC;4BACG,OAAM;4BACN,MAAK;4BACL,OAAO;4BACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;4BAC7C,WAAU;;;;;;sCAId,6LAAC;4BACG,OAAM;4BACN,MAAK;4BACL,KAAK;4BACL,KAAK;4BACL,OAAO;4BACP,UAAU,CAAC,IAAM,cAAc,OAAO,EAAE,MAAM,CAAC,KAAK;4BACpD,WAAU;;;;;;sCAGd,6LAAC;4BAAI,WAAU;;;;;;sCAGf,6LAAC;4BAAO,OAAM;4BAAO,SAAS;4BAAY,WAAU;sCAChD,cAAA,6LAAC,oNAAK;gCAAC,WAAU;;;;;;;;;;;sCAErB,6LAAC;4BAAO,OAAM;4BAAO,SAAS;4BAAY,WAAU;sCAChD,cAAA,6LAAC,oNAAK;gCAAC,WAAU;;;;;;;;;;;sCAGrB,6LAAC;4BAAI,WAAU;;;;;;sCAGf,6LAAC;4BACG,OAAM;4BACN,SAAS;oCAAM;wCAAA,8BAAA,mBAAmB,OAAO,cAA1B,kDAAA,4BAA4B,OAAO;;4BAClD,WAAU;sCAEV,cAAA,6LAAC,0NAAO;gCAAC,WAAU;;;;;;;;;;;sCAEvB,6LAAC;4BACG,OAAM;4BACN,SAAS;oCAAM;wCAAA,8BAAA,mBAAmB,OAAO,cAA1B,kDAAA,4BAA4B,MAAM;;4BACjD,WAAU;sCAEV,cAAA,6LAAC,uNAAM;gCAAC,WAAU;;;;;;;;;;;sCAItB,6LAAC;4BACG,OAAM;4BACN,aAAY;4BACZ,OAAO;4BACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;4BAC3C,WAAU;;;;;;sCAEd,6LAAC;4BAAO,OAAM;4BAAU,SAAS;4BAAe,WAAU;sCACtD,cAAA,6LAAC,yNAAQ;gCAAC,WAAU;;;;;;;;;;;sCAGxB,6LAAC;4BAAI,WAAU;;;;;;sCAGf,6LAAC;4BACG,OAAM;4BACN,SAAS,IAAM,YAAY,CAAC,IAAM,CAAC;4BACnC,WAAW,AAAC,+CAA4E,OAA9B,WAAW,gBAAgB;sCAErF,cAAA,6LAAC,oNAAI;gCAAC,WAAW,AAAC,WAAuD,OAA7C,WAAW,kBAAkB;;;;;;;;;;;sCAG7D,6LAAC;4BAAI,WAAU;;;;;;sCAGf,6LAAC;4BAAM,WAAU;;8CACb,6LAAC;oCACG,MAAK;oCACL,SAAS;oCACT,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,OAAO;oCAChD,WAAU;;;;;;8CAEd,6LAAC,sNAAO;oCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAM3C;GAjWwB;;QACD,kJAAS;;;KADR","debugId":null}}]
}